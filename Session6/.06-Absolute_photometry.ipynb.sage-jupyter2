{"backend_state":"ready","connection_file":"/tmp/xdg-runtime-user/jupyter/kernel-a07dd0ef-14b4-4136-b224-b58f35458442.json","kernel":"python3","kernel_error":"","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":0},"last_backend_state":1734631266872,"last_ipynb_save":1734632837274,"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.6.9"}},"trust":true,"type":"settings"}
{"cell_type":"code","end":1734529093063,"exec_count":18,"id":"900a8d","input":"# CALCULATE THE ZEROPOINT AND ADD IT TO THE MAGNITUDE COLUMN OF THE V300 table\nimport numpy as np\nmask = xmatch[\"Vmag\"] >= 12.7\nmag = xmatch[\"Vmag\"]\nZP = delta_mag[mask]\nZP_median = np.median(ZP)\nV300['calibrated_mag'] = V300['instrumental_mag'] + ZP_median\nprint(f\"The median for the masked zero point is {np.median(ZP)}\")\nV300","kernel":"python3","last":13,"output":{"0":{"name":"stdout","text":"The median for the masked zero point is 21.19673186627411\n"},"1":{"name":"stderr","text":"/home/user/.local/lib/python3.10/site-packages/numpy/core/fromnumeric.py:771: UserWarning: Warning: 'partition' will ignore the 'mask' of the MaskedColumn.\n  a.partition(kth, axis=axis, kind=kind, order=order)\n"},"2":{"data":{"text/html":"<div><i>QTable length=1791</i>\n<table id=\"table139728419570256\" class=\"table-striped table-bordered table-condensed\">\n<thead><tr><th>id</th><th>xcenter</th><th>ycenter</th><th>aperture_sum</th><th>aperture_sum_err</th><th>sky_mean</th><th>aper_bkg</th><th>aper_sum_bksub</th><th>RA</th><th>DEC</th><th>instrumental_mag</th><th>e_instrumental_mag</th><th>calibrated_mag</th></tr></thead>\n<thead><tr><th></th><th>pix</th><th>pix</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead>\n<thead><tr><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>\n<tr><td>1</td><td>450.1709193760241</td><td>0.3880226773402493</td><td>613274.2821607713</td><td>896.7627345794019</td><td>6546.836504099991</td><td>514187.3366383504</td><td>99086.94552242092</td><td>359.30845514940125</td><td>56.61907252560987</td><td>-6.297237965583777</td><td>0.009050261160553049</td><td>14.899493900690333</td></tr>\n<tr><td>2</td><td>478.89419941776816</td><td>0.5762631357085911</td><td>639555.492461868</td><td>915.7591073362786</td><td>6615.785732777475</td><td>519602.59639544704</td><td>119952.89606642094</td><td>359.3226414907986</td><td>56.61921386745884</td><td>-6.504723707601205</td><td>0.007634322616347668</td><td>14.692008158672905</td></tr>\n<tr><td>3</td><td>949.8117754685048</td><td>0.36503649582442277</td><td>668676.4253870292</td><td>936.0414511119112</td><td>6518.6643764959035</td><td>511974.7029104255</td><td>156701.7224766037</td><td>359.55525335036356</td><td>56.62040541214033</td><td>-6.794881288928362</td><td>0.005973396056649387</td><td>14.401850577345748</td></tr>\n<tr><td>4</td><td>165.2496454298732</td><td>3.3423657101402853</td><td>943073.2156594956</td><td>1112.0141472087325</td><td>7354.167424647708</td><td>577594.9588635652</td><td>365478.2567959303</td><td>359.1677069113511</td><td>56.618892608824474</td><td>-7.7143507252287495</td><td>0.0030426273698400627</td><td>13.48238114104536</td></tr>\n<tr><td>5</td><td>1071.249859368704</td><td>3.0485143206828598</td><td>910783.1455810051</td><td>1092.8465302890327</td><td>7310.974963652827</td><td>574202.6309097656</td><td>336580.51467123954</td><td>359.61523045959893</td><td>56.62138597252419</td><td>-7.624919288648352</td><td>0.003246909677336753</td><td>13.571812577625758</td></tr>\n<tr><td>6</td><td>348.04474005431854</td><td>7.131155178370917</td><td>1076966.1215255137</td><td>1188.0091077859397</td><td>8435.966010472113</td><td>662559.2211108097</td><td>414406.900414704</td><td>359.25797086439985</td><td>56.62057012490107</td><td>-7.8507643091164105</td><td>0.0028667696088001404</td><td>13.3459675571577</td></tr>\n<tr><td>7</td><td>1034.1174172270996</td><td>7.352485478794329</td><td>1081159.3925166368</td><td>1190.3011771273914</td><td>8672.622222734011</td><td>681146.1565575189</td><td>400013.2359591179</td><td>359.59687193260726</td><td>56.6224810846864</td><td>-7.812382767826401</td><td>0.0029756544787159053</td><td>13.384349098447709</td></tr>\n<tr><td>8</td><td>1049.4292719479813</td><td>7.122996880789271</td><td>1130243.172474711</td><td>1216.809682684952</td><td>8533.404467275459</td><td>670212.0196125726</td><td>460031.15286213835</td><td>359.6044367452124</td><td>56.622449553407165</td><td>-7.964164969893959</td><td>0.002645059307645637</td><td>13.23256689638015</td></tr>\n<tr><td>9</td><td>1076.5677709563297</td><td>7.361628914876675</td><td>1005306.513960734</td><td>1148.1324635098197</td><td>7398.885141871636</td><td>581107.0801614652</td><td>424199.4337992688</td><td>359.617842189201</td><td>56.62256783242932</td><td>-7.876122074465394</td><td>0.0027065865063203172</td><td>13.320609791808716</td></tr>\n<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>\n<tr><td>1782</td><td>584.0272762704734</td><td>732.9847718966361</td><td>1015111.8614907449</td><td>1152.7198319229624</td><td>7166.654230045673</td><td>562867.7069982425</td><td>452244.15449250233</td><td>359.3706830127341</td><td>56.81845650954345</td><td>-7.945629268376205</td><td>0.0025488882951212872</td><td>13.251102597897905</td></tr>\n<tr><td>1783</td><td>739.4645226601071</td><td>732.5758436441275</td><td>852303.7886316715</td><td>1057.1690358314736</td><td>7063.719287825017</td><td>554783.21554129</td><td>297520.57309038145</td><td>359.4478703051436</td><td>56.81877586361126</td><td>-7.490989367948048</td><td>0.0035532636444281264</td><td>13.705742498326062</td></tr>\n<tr><td>1784</td><td>1055.1906322987409</td><td>732.506594344748</td><td>879813.247221312</td><td>1073.987452825618</td><td>7126.912566942495</td><td>559746.404077083</td><td>320066.84314422903</td><td>359.6046544715844</td><td>56.819484702519674</td><td>-7.570298579134917</td><td>0.0033555098749846325</td><td>13.626433287139193</td></tr>\n<tr><td>1785</td><td>556.6605923426521</td><td>734.2746797893597</td><td>648943.3363706131</td><td>922.5116857846762</td><td>6623.724684413247</td><td>520226.1201988507</td><td>128717.21617176238</td><td>359.35708673518695</td><td>56.81872614194346</td><td>-6.581288459450731</td><td>0.007166964243179881</td><td>14.61544340682338</td></tr>\n<tr><td>1786</td><td>943.6319852764369</td><td>733.4642048886762</td><td>751420.9600005958</td><td>992.6482166562585</td><td>6838.9056503223055</td><td>537126.393741157</td><td>214294.56625943875</td><td>359.54925201416563</td><td>56.81951014439502</td><td>-7.134724760783715</td><td>0.004632166993233486</td><td>14.062007105490395</td></tr>\n<tr><td>1787</td><td>975.4491612420895</td><td>734.483003155004</td><td>970892.9305002791</td><td>1126.6188104688008</td><td>6701.3421562434605</td><td>526322.182181151</td><td>444570.74831912806</td><td>359.565048061202</td><td>56.8198562882821</td><td>-7.927049072639981</td><td>0.002534172153090188</td><td>13.269682793634129</td></tr>\n<tr><td>1788</td><td>664.5833217332253</td><td>734.7106183957839</td><td>605207.2101741943</td><td>890.8177034459861</td><td>6524.734274230677</td><td>512451.4315637157</td><td>92755.77861047862</td><td>359.4106757347279</td><td>56.819154274518596</td><td>-6.225549301518787</td><td>0.00960390518834317</td><td>14.971182564755324</td></tr>\n<tr><td>1789</td><td>709.9082904039421</td><td>734.7442329203955</td><td>616464.5813596707</td><td>898.9677075828698</td><td>6490.546016075493</td><td>509766.2920472317</td><td>106698.28931243904</td><td>359.4331829160297</td><td>56.81928663720395</td><td>-6.377590504355184</td><td>0.008425324467484849</td><td>14.819141361918927</td></tr>\n<tr><td>1790</td><td>787.7168148092121</td><td>734.657437649733</td><td>642322.8537607085</td><td>917.5413172841851</td><td>6521.496898408594</td><td>512197.1686612265</td><td>130125.68509948195</td><td>359.4718215813665</td><td>56.819465170517965</td><td>-6.59310443581128</td><td>0.007051192979946416</td><td>14.60362743046283</td></tr>\n<tr><td>1791</td><td>883.970793036267</td><td>734.4440442323319</td><td>631135.6252938292</td><td>909.7474075988646</td><td>6544.965257651643</td><td>514040.36928597075</td><td>117095.2560078585</td><td>359.51962090543225</td><td>56.819640715560176</td><td>-6.4785451143031025</td><td>0.007769293467685913</td><td>14.718186751971007</td></tr>\n</table></div>","text/plain":"<QTable length=1791>\n  id       xcenter       ...   e_instrumental_mag    calibrated_mag  \n             pix         ...                                         \nint64      float64       ...        float64             float64      \n----- ------------------ ... --------------------- ------------------\n    1  450.1709193760241 ...  0.009050261160553049 14.899493900690333\n    2 478.89419941776816 ...  0.007634322616347668 14.692008158672905\n    3  949.8117754685048 ...  0.005973396056649387 14.401850577345748\n    4  165.2496454298732 ... 0.0030426273698400627  13.48238114104536\n    5  1071.249859368704 ...  0.003246909677336753 13.571812577625758\n    6 348.04474005431854 ... 0.0028667696088001404   13.3459675571577\n    7 1034.1174172270996 ... 0.0029756544787159053 13.384349098447709\n    8 1049.4292719479813 ...  0.002645059307645637  13.23256689638015\n    9 1076.5677709563297 ... 0.0027065865063203172 13.320609791808716\n  ...                ... ...                   ...                ...\n 1782  584.0272762704734 ... 0.0025488882951212872 13.251102597897905\n 1783  739.4645226601071 ... 0.0035532636444281264 13.705742498326062\n 1784 1055.1906322987409 ... 0.0033555098749846325 13.626433287139193\n 1785  556.6605923426521 ...  0.007166964243179881  14.61544340682338\n 1786  943.6319852764369 ...  0.004632166993233486 14.062007105490395\n 1787  975.4491612420895 ...  0.002534172153090188 13.269682793634129\n 1788  664.5833217332253 ...   0.00960390518834317 14.971182564755324\n 1789  709.9082904039421 ...  0.008425324467484849 14.819141361918927\n 1790  787.7168148092121 ...  0.007051192979946416  14.60362743046283\n 1791   883.970793036267 ...  0.007769293467685913 14.718186751971007"},"exec_count":18}},"pos":36,"start":1734529093042,"state":"done","type":"cell"}
{"cell_type":"code","end":1734529101675,"exec_count":21,"id":"a9efc6","input":"mean_background, median_background, background_standard_deviation = sigma_clipped_stats(B_300_data, sigma=3.0)\nprint(\"The background has an average value of {:.1f} and a standard deviation of {:.1f} counts\".format(mean_background, background_standard_deviation))\n\n#Create B300 sources\nB_300_sources = daofind(B_300_data - median_background)\n\n#Plot B300 sources\nplot_sources(B_300_data, B_300_sources, 3)\nmeasure_FWHM(B_300_data, B_300_sources)\n\n#Create B300 table\nB300 = aperture_photometry(B_300_data, B_300_header, B_300_sources, 5, 10, 20) ","kernel":"python3","last":6638,"output":{"0":{"name":"stdout","text":"The background has an average value of 4614.2 and a standard deviation of 38.9 counts\n"},"1":{"data":{"image/png":"76f7d0177c0718f7026df54f522e10bd46c80983","text/plain":"<Figure size 1080x864 with 1 Axes>"},"metadata":{"image/png":{"height":595,"width":877},"needs_background":"light"}},"2":{"data":{"image/png":"d8a882ad9a2f37d0c23826ce1d3e364f0ecd3246","text/plain":"<Figure size 936x432 with 2 Axes>"},"metadata":{"image/png":{"height":370,"width":771},"needs_background":"light"}}},"pos":40,"start":1734529093237,"state":"done","type":"cell"}
{"cell_type":"code","end":1734529113373,"exec_count":30,"id":"b82f86","input":"from astropy.coordinates import SkyCoord\n\ncoo_V300 = SkyCoord(V300['RA'], V300['DEC'], unit=u.deg)\ncoo_B300 = SkyCoord(B300['RA'], B300['DEC'], unit=u.deg)\nidx, distance_2d, distance_3d = coo_V300.match_to_catalog_sky(coo_B300)\nB300 = B300[idx]\nmask = distance_2d < 3 * u.arcsec\nB300 = B300[mask]\nV300 = V300[mask]","kernel":"python3","last":72,"pos":45,"start":1734529113358,"state":"done","type":"cell"}
{"cell_type":"code","end":1734529114239,"id":"782fdd","input":"#Stack V_mag, BV mag and error coloumns into 1d NP array \ndata_out300 = np.column_stack([V300_mag, B_minus_V_300, error300])\ndata_out30 = np.column_stack([V30_mag, B_minus_V_30, error30])\n\n#Create file path to save data to \nfilepath300 = '../../observing_project/calibrated_data_300'\nfilepath30 = '../../observing_project/calibrated_data_30'\n\n#Save 1d arrays to filepaths\nnp.savetxt(f\"{filepath300}.csv\", data_out300, delimiter=',', header=\"V, B-V, B-V_Error\")\nnp.savetxt(f\"{filepath30}.csv\", data_out30, delimiter=',', header=\"V, B-V, Error\")","kernel":"python3","last":0,"pos":49,"start":1734529114239,"state":"done","type":"cell"}
{"cell_type":"code","end":1734529395291,"exec_count":33,"id":"80c80f","input":"#Create arryas of V and B calibrated data \nV300_mag = V300['calibrated_mag']\nB300_mag = B300['calibrated_mag']\n\n# Load in error on instrumental magnitude for B and V \nV300_error = V300['e_instrumental_mag']\nB300_error = B300['e_instrumental_mag']\n\n# Calculate B-V\nB_minus_V_300 = B300_mag - V300_mag\n\n#Calculate error on B-Vv\nerror300 = np.sqrt((V300_error**2) + (B300_error**2))\nprint(error300.shape)\n\n#Plot V against B-V\n#plt.scatter(B_minus_V, V)\nplt.errorbar(B_minus_V_300, V300_mag, xerr=error300, fmt=\"o\", ecolor=\"r\")\nplt.xlim(-1, 2.5)\n\n#Invert Y axis\nplt.gca().invert_yaxis()\n\n#Plot formatting\nplt.xlabel(\"Colour index B-V\")\nplt.ylabel(\"Apparent Visual Magnitude V\")\nplt.title(\"Colour Magnitude diagram of NGC 7789 (300 second exposure time)\")\nplt.grid()\n\nplt.show()","kernel":"python3","last":32,"output":{"0":{"name":"stdout","text":"(955,)\n"},"1":{"data":{"image/png":"c4c184e6d7427a1f879c83bb596aaa27cb525ccf","text/plain":"<Figure size 864x504 with 1 Axes>"},"metadata":{"image/png":{"height":440,"width":725},"needs_background":"light"}}},"pos":47,"start":1734529394720,"state":"done","type":"cell"}
{"cell_type":"code","end":1734622270131,"exec_count":3,"id":"cecbc5","input":"from IPython.core.display import HTML\ncss_file = '../../styles/styles.css'\nHTML(open(css_file, \"r\").read())","kernel":"python3","last":14,"output":{"0":{"data":{"text/html":"<link href='http://fonts.googleapis.com/css?family=Crimson+Text' rel='stylesheet' type='text/css'>\n<link href='http://fonts.googleapis.com/css?family=Kameron' rel='stylesheet' type='text/css'>\n<link href='http://fonts.googleapis.com/css?family=Lato:200,300,400' rel='stylesheet' type='text/css'>\n<link href='http://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>\n<style>\n\n@font-face {\n    font-family: \"Computer Modern\";\n    src: url('http://mirrors.ctan.org/fonts/cm-unicode/fonts/otf/cmunss.otf');\n}\n\n#notebook_panel { /* main background */\n    background: rgb(245,245,245);\n}\n\n\ndiv #notebook { /* centre the content */\n    background: #fff; /* white background for content */\n    margin: auto;\n    padding-left: 0em;\n}\n\n\n#notebook li { /* More space between bullet points */\n    margin-top:0.8em;\n}\n\n/* draw border around running cells */\ndiv.cell.border-box-sizing.code_cell.running { \n    border: 1px solid #111;\n}\n\n/* Put a solid color box around each cell and its output, visually linking them*/\ndiv.cell.code_cell {\n    background-color: rgb(256,256,256); \n    border-radius: 0px; \n    /* width: 105ex; */\n    padding: 0.5em;\n    margin-left:1em;\n    margin-top: 1em;\n}\n\ndiv.input_area {\n    border-color: rgba(0,0,0,0.10);\n    background: rbga(0,0,0,0.5);\n}\n\n/*\ndiv.text_cell {\n    max-width: 105ex; /* instead of 100%, */\n}\n*/\n\ndiv.text_cell_render {\n    font-family: \"Crimson Text\";\n    font-size: 12pt;\n    line-height: 145%; /* added for some line spacing of text. */\n}\n\ndiv.text_cell_render h1,\ndiv.text_cell_render h2,\ndiv.text_cell_render h3,\ndiv.text_cell_render h4,\ndiv.text_cell_render h5,\ndiv.text_cell_render h6 {\n    font-family: 'Kameron';\n    font-weight: 300;\n}\n\ndiv.text_cell_render h1 {\n    font-size: 24pt;\n}\n\ndiv.text_cell_render h2 {\n    font-size: 18pt;\n}\n\ndiv.text_cell_render h3 {\n    font-size: 14pt;\n}\n\n.rendered_html pre,\n.rendered_html code {\n    font-size: medium;\n    background-color: rgba(246,246,246,1);\n    padding: 2px;\n}\n\n.rendered_html ol {\n    list-style:decimal;\n    margin: 1em 2em;\n}\n\n.CodeMirror pre{\n        font-family: 'Source Code Pro', Consolas, monocco, monospace;\n}\n\n/* Make space between the fa icon and the rest of the header */\n.panel-heading h1 span,\n.panel-heading h2 span,\n.panel-heading h3 span,\n.panel-heading h4 span,\n.panel-heading h5 span,\n.panel-heading h6 span {\n    padding-right: 10px;\n}\n\n.fa {\n    padding: 5px;\n    }\n   \nkbd {\n    padding:0.1em 0.6em;\n    border:1px solid #ccc;\n    font-size:11px;\n    font-family:Arial,Helvetica,sans-serif;\n    background-color:#f7f7f7;\n    color:#333;\n    -moz-box-shadow:0 1px 0px rgba(0, 0, 0, 0.2),0 0 0 2px #ffffff inset;\n    -webkit-box-shadow:0 1px 0px rgba(0, 0, 0, 0.2),0 0 0 2px #ffffff inset;\n    box-shadow:0 1px 0px rgba(0, 0, 0, 0.2),0 0 0 2px #ffffff inset;\n    -moz-border-radius:3px;\n    -webkit-border-radius:3px;\n    border-radius:3px;\n    display:inline-block;\n    margin:0 0.1em;\n    text-shadow:0 1px 0 #fff;\n    line-height:1.4;\n    white-space:nowrap;\n}\n\n</style>\n<script>\n    MathJax.Hub.Config({\n                        TeX: {\n                           extensions: [\"AMSmath.js\"],\n                           equationNumbers: { autoNumber: \"AMS\", useLabelIds: true}\n                           },\n                tex2jax: {\n                    inlineMath: [ ['$','$'], [\"\\\\(\",\"\\\\)\"] ],\n                    displayMath: [ ['$$','$$'], [\"\\\\[\",\"\\\\]\"] ]\n                },\n                displayAlign: 'center', // Change this to 'center' to center equations.\n                \"HTML-CSS\": {\n                    styles: {'.MathJax_Display': {\"margin\": 4}}\n                }\n        });\n</script>","text/plain":"<IPython.core.display.HTML object>"},"exec_count":3}},"pos":0,"start":1734622270114,"state":"done","type":"cell"}
{"cell_type":"code","end":1734622270140,"exec_count":4,"id":"9d776f","input":"## IMPORTANT: YOU ONLY NEED TO RUN THIS CELL ONCE, BUT RE-RUNNING IS HARMLESS\n#import sys\n#!{sys.executable} -m pip install photutils","kernel":"python3","last":96,"pos":5,"start":1734622270136,"state":"done","type":"cell"}
{"cell_type":"code","end":1734622270276,"exec_count":5,"id":"6ac2f0","input":"## if this code cell runs without error, you have successfully installed photutils!\nimport sys\nsys.path.append('/home/user/.local/lib/python3.10/site-packages')\nimport photutils as p","kernel":"python3","last":38,"pos":7,"start":1734622270178,"state":"done","type":"cell"}
{"cell_type":"code","end":1734622272504,"exec_count":6,"id":"cfb89a","input":"from astropy.io import fits\n#read in calibrated data \n\nV_300 = '../../observing_project/V_300_calib'\n\n\ndata = fits.getdata(V_300)\nheader  = fits.getheader(V_300)","kernel":"python3","last":1670,"pos":10,"start":1734622270282,"state":"done","type":"cell"}
{"cell_type":"code","end":1734622274381,"exec_count":7,"id":"4df72e","input":"# import sigma_clipping function from astropy\nfrom astropy.stats import sigma_clipped_stats\n\nmean_background, median_background, background_standard_deviation = sigma_clipped_stats(data, sigma=3.0)\n\nprint(\"The background has an average value of {:.1f} and a standard deviation of {:.1f} counts\".format(\n    mean_background, background_standard_deviation))","kernel":"python3","last":1650,"output":{"0":{"name":"stdout","text":"The background has an average value of 12593.1 and a standard deviation of 68.4 counts\n"}},"pos":12,"start":1734622272516,"state":"done","type":"cell"}
{"cell_type":"code","end":1734622277456,"exec_count":8,"id":"c91b2f","input":"from photutils.detection import DAOStarFinder\n\n# make a star finder object to look for stars with FWHM~3 pixels that are more than 5-sigma above background\ndaofind = DAOStarFinder(fwhm=3.0, threshold=5*background_standard_deviation)\n# use it to find stars. We'll subtract the background off first, so background pixels have an average value of 0\nsources = daofind(data - median_background)\n\nprint(sources)","kernel":"python3","last":2941,"output":{"0":{"name":"stdout","text":" id      xcentroid      ...         mag             daofind_mag     \n---- ------------------ ... ------------------- --------------------\n   1  450.1709193760241 ...   -9.38217153377785  -0.7895601213639031\n   2 478.89419941776816 ...  -9.572295166953268  -0.8015407310322573\n   3  949.8117754685048 ...  -11.69046496918724   -2.991478281108468\n   4  165.2496454298732 ... -10.399944792009952  -1.1915560803546072\n   5  1071.249859368704 ...  -9.759678664790112  -0.5416841797948282\n   6 348.04474005431854 ... -12.102045749320158  -2.7799641313186614\n   7 1034.1174172270996 ... -12.142313292254537    -2.87434651439276\n   8 1049.4292719479813 ... -12.596128868652688  -3.2572572340552624\n   9 1076.5677709563297 ... -10.224460291010523  -0.9077068010922966\n  10 231.72140015826452 ... -12.145377949333211  -2.8575462596199444\n ...                ... ...                 ...                  ...\n1781  509.5097980110094 ... -10.391160595376478  -1.0877794414756237\n1782  584.0272762704734 ... -13.171149235411242  -3.9404728643998057\n1783  739.4645226601071 ... -10.053960731663658  -0.7630601777547612\n1784 1055.1906322987409 ... -11.012592594184479  -1.5944930263838946\n1785  556.6605923426521 ...  -8.166747345247217 -0.08744116659912136\n1786  943.6319852764369 ...  -9.616719389944835  -0.4722642044717679\n1787  975.4491612420895 ... -13.691827040692559   -4.823254105156957\n1788  664.5833217332253 ... -10.021341460708282  -1.5494589066531588\n1789  709.9082904039421 ... -10.891591472864592  -2.4457855268345305\n1790  787.7168148092121 ... -11.361960765128403   -2.873849624581469\n1791   883.970793036267 ...  -9.072755098481988  -0.4990443025479364\nLength = 1791 rows\n"}},"pos":14,"start":1734622274386,"state":"done","type":"cell"}
{"cell_type":"code","end":1734622288678,"exec_count":9,"id":"46db21","input":"from photometry_helpers import plot_sources\nhelp(plot_sources)\n    \nplot_sources(data, sources, 3)","kernel":"python3","last":12510,"output":{"0":{"name":"stdout","text":"Help on function plot_sources in module photometry_helpers:\n\nplot_sources(data, sources, radius)\n    Plot positions of detected sources on image.\n    \n    Parameters\n    ----------\n    data:  `np.ndarray`\n        A 2D array of pixel values of your data. From a FITS file, you can create this array with\n        `fits.getdata`.\n    \n    sources: `~astropy.table.Table`\n        A table of detected sources for the image. Usually, `photutils.DAOStarFinder` would be\n        used to create this list.\n    \n    radius: float\n        The size of apertures to plot, in pixels\n\n"},"1":{"data":{"image/png":"5e83b134d3f65bf9aafc8a2397f33a2e7dc464ec","text/plain":"<Figure size 1080x864 with 1 Axes>"},"metadata":{"image/png":{"height":595,"width":877},"needs_background":"light"}}},"pos":16,"start":1734622277462,"state":"done","type":"cell"}
{"cell_type":"code","end":1734622289500,"exec_count":10,"id":"d1ac9d","input":"from photometry_helpers import measure_FWHM\n\nmeasure_FWHM(data, sources)","kernel":"python3","last":1591,"output":{"0":{"data":{"image/png":"d1904b962706d5c02c16dcf16f95c107aacbe63a","text/plain":"<Figure size 936x432 with 2 Axes>"},"metadata":{"image/png":{"height":370,"width":771},"needs_background":"light"}}},"pos":18,"start":1734622288685,"state":"done","type":"cell"}
{"cell_type":"code","end":1734622289510,"exec_count":11,"id":"7c87e5","input":"from photometry_helpers import aperture_photometry\nhelp(aperture_photometry)","kernel":"python3","last":4,"output":{"0":{"name":"stdout","text":"Help on function aperture_photometry in module photometry_helpers:\n\naperture_photometry(data, header, sources, aperture_radius, sky_inner_radius, sky_outer_radius)\n    Calculate Aperture Photometry on a list of sources\n    \n    Parameters\n    ----------\n    data:  `np.ndarray`\n        A 2D array of pixel values of your data. From a FITS file, you can create this array with\n        `fits.getdata`.\n    \n    header: `~astropy.fits.Header`\n        A FITS Header object. From a FITS file, you can create this object with\n        `fits.getheader`.\n    \n    sources: `~astropy.table.Table`\n        A table of detected sources for the image. Usually, `photutils.DAOStarFinder` would be\n        used to create this list.\n    \n    aperture_radius: float\n        Radius of the target aperture, in pixels\n    \n    sky_inner_radius: float\n        Radius of the inner aperture that makes up the sky annulus\n    \n    sky_outer_radius: float\n        Radius of the outer aperture that makes up the sky annulus\n    \n    Returns\n    -------\n    phot_table: `~astropy.table.Table`\n        A table of measurements for each source, including instrumental magnitude and error.\n\n"}},"pos":20,"start":1734622289506,"state":"done","type":"cell"}
{"cell_type":"code","end":1734622290088,"exec_count":12,"id":"ae865e","input":"# YOUR CODE HERE. USE THE FUNCTION ABOVE TO PERFORM APERTURE PHOTOMETRY\nV300 = aperture_photometry(data, header, sources, 5, 10, 20) \n# SAVE THE TABLE RETURNED IN A SUITABLY NAMED VARIABLE. Perhaps call it V300.","kernel":"python3","last":696,"pos":22,"start":1734622289517,"state":"done","type":"cell"}
{"cell_type":"code","end":1734622290580,"exec_count":13,"id":"e162f5","input":"from astropy import units as u\nfrom astroquery.xmatch import XMatch","kernel":"python3","last":1064,"output":{"0":{"name":"stdout","text":"Could not import regions, which is required for some of the functionalities of this module.\n"}},"pos":24,"start":1734622290097,"state":"done","type":"cell"}
{"cell_type":"code","end":1734622290594,"exec_count":14,"id":"3aca65","input":"V300","kernel":"python3","last":12,"output":{"0":{"data":{"text/html":"<div><i>QTable length=1791</i>\n<table id=\"table140296852994512\" class=\"table-striped table-bordered table-condensed\">\n<thead><tr><th>id</th><th>xcenter</th><th>ycenter</th><th>aperture_sum</th><th>aperture_sum_err</th><th>sky_mean</th><th>aper_bkg</th><th>aper_sum_bksub</th><th>RA</th><th>DEC</th><th>instrumental_mag</th><th>e_instrumental_mag</th></tr></thead>\n<thead><tr><th></th><th>pix</th><th>pix</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead>\n<thead><tr><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>\n<tr><td>1</td><td>450.1709193760241</td><td>0.3880226773402493</td><td>613274.2821607713</td><td>896.7627345794019</td><td>6546.836504099991</td><td>514187.3366383504</td><td>99086.94552242092</td><td>359.30845514940125</td><td>56.61907252560987</td><td>-6.297237965583777</td><td>0.009050261160553049</td></tr>\n<tr><td>2</td><td>478.89419941776816</td><td>0.5762631357085911</td><td>639555.492461868</td><td>915.7591073362786</td><td>6615.785732777475</td><td>519602.59639544704</td><td>119952.89606642094</td><td>359.3226414907986</td><td>56.61921386745884</td><td>-6.504723707601205</td><td>0.007634322616347668</td></tr>\n<tr><td>3</td><td>949.8117754685048</td><td>0.36503649582442277</td><td>668676.4253870292</td><td>936.0414511119112</td><td>6518.6643764959035</td><td>511974.7029104255</td><td>156701.7224766037</td><td>359.55525335036356</td><td>56.62040541214033</td><td>-6.794881288928362</td><td>0.005973396056649387</td></tr>\n<tr><td>4</td><td>165.2496454298732</td><td>3.3423657101402853</td><td>943073.2156594956</td><td>1112.0141472087325</td><td>7354.167424647708</td><td>577594.9588635652</td><td>365478.2567959303</td><td>359.1677069113511</td><td>56.618892608824474</td><td>-7.7143507252287495</td><td>0.0030426273698400627</td></tr>\n<tr><td>5</td><td>1071.249859368704</td><td>3.0485143206828598</td><td>910783.1455810051</td><td>1092.8465302890327</td><td>7310.974963652827</td><td>574202.6309097656</td><td>336580.51467123954</td><td>359.61523045959893</td><td>56.62138597252419</td><td>-7.624919288648352</td><td>0.003246909677336753</td></tr>\n<tr><td>6</td><td>348.04474005431854</td><td>7.131155178370917</td><td>1076966.1215255137</td><td>1188.0091077859397</td><td>8435.966010472113</td><td>662559.2211108097</td><td>414406.900414704</td><td>359.25797086439985</td><td>56.62057012490107</td><td>-7.8507643091164105</td><td>0.0028667696088001404</td></tr>\n<tr><td>7</td><td>1034.1174172270996</td><td>7.352485478794329</td><td>1081159.3925166368</td><td>1190.3011771273914</td><td>8672.622222734011</td><td>681146.1565575189</td><td>400013.2359591179</td><td>359.59687193260726</td><td>56.6224810846864</td><td>-7.812382767826401</td><td>0.0029756544787159053</td></tr>\n<tr><td>8</td><td>1049.4292719479813</td><td>7.122996880789271</td><td>1130243.172474711</td><td>1216.809682684952</td><td>8533.404467275459</td><td>670212.0196125726</td><td>460031.15286213835</td><td>359.6044367452124</td><td>56.622449553407165</td><td>-7.964164969893959</td><td>0.002645059307645637</td></tr>\n<tr><td>9</td><td>1076.5677709563297</td><td>7.361628914876675</td><td>1005306.513960734</td><td>1148.1324635098197</td><td>7398.885141871636</td><td>581107.0801614652</td><td>424199.4337992688</td><td>359.617842189201</td><td>56.62256783242932</td><td>-7.876122074465394</td><td>0.0027065865063203172</td></tr>\n<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>\n<tr><td>1782</td><td>584.0272762704734</td><td>732.9847718966361</td><td>1015111.8614907449</td><td>1152.7198319229624</td><td>7166.654230045673</td><td>562867.7069982425</td><td>452244.15449250233</td><td>359.3706830127341</td><td>56.81845650954345</td><td>-7.945629268376205</td><td>0.0025488882951212872</td></tr>\n<tr><td>1783</td><td>739.4645226601071</td><td>732.5758436441275</td><td>852303.7886316715</td><td>1057.1690358314736</td><td>7063.719287825017</td><td>554783.21554129</td><td>297520.57309038145</td><td>359.4478703051436</td><td>56.81877586361126</td><td>-7.490989367948048</td><td>0.0035532636444281264</td></tr>\n<tr><td>1784</td><td>1055.1906322987409</td><td>732.506594344748</td><td>879813.247221312</td><td>1073.987452825618</td><td>7126.912566942495</td><td>559746.404077083</td><td>320066.84314422903</td><td>359.6046544715844</td><td>56.819484702519674</td><td>-7.570298579134917</td><td>0.0033555098749846325</td></tr>\n<tr><td>1785</td><td>556.6605923426521</td><td>734.2746797893597</td><td>648943.3363706131</td><td>922.5116857846762</td><td>6623.724684413247</td><td>520226.1201988507</td><td>128717.21617176238</td><td>359.35708673518695</td><td>56.81872614194346</td><td>-6.581288459450731</td><td>0.007166964243179881</td></tr>\n<tr><td>1786</td><td>943.6319852764369</td><td>733.4642048886762</td><td>751420.9600005958</td><td>992.6482166562585</td><td>6838.9056503223055</td><td>537126.393741157</td><td>214294.56625943875</td><td>359.54925201416563</td><td>56.81951014439502</td><td>-7.134724760783715</td><td>0.004632166993233486</td></tr>\n<tr><td>1787</td><td>975.4491612420895</td><td>734.483003155004</td><td>970892.9305002791</td><td>1126.6188104688008</td><td>6701.3421562434605</td><td>526322.182181151</td><td>444570.74831912806</td><td>359.565048061202</td><td>56.8198562882821</td><td>-7.927049072639981</td><td>0.002534172153090188</td></tr>\n<tr><td>1788</td><td>664.5833217332253</td><td>734.7106183957839</td><td>605207.2101741943</td><td>890.8177034459861</td><td>6524.734274230677</td><td>512451.4315637157</td><td>92755.77861047862</td><td>359.4106757347279</td><td>56.819154274518596</td><td>-6.225549301518787</td><td>0.00960390518834317</td></tr>\n<tr><td>1789</td><td>709.9082904039421</td><td>734.7442329203955</td><td>616464.5813596707</td><td>898.9677075828698</td><td>6490.546016075493</td><td>509766.2920472317</td><td>106698.28931243904</td><td>359.4331829160297</td><td>56.81928663720395</td><td>-6.377590504355184</td><td>0.008425324467484849</td></tr>\n<tr><td>1790</td><td>787.7168148092121</td><td>734.657437649733</td><td>642322.8537607085</td><td>917.5413172841851</td><td>6521.496898408594</td><td>512197.1686612265</td><td>130125.68509948195</td><td>359.4718215813665</td><td>56.819465170517965</td><td>-6.59310443581128</td><td>0.007051192979946416</td></tr>\n<tr><td>1791</td><td>883.970793036267</td><td>734.4440442323319</td><td>631135.6252938292</td><td>909.7474075988646</td><td>6544.965257651643</td><td>514040.36928597075</td><td>117095.2560078585</td><td>359.51962090543225</td><td>56.819640715560176</td><td>-6.4785451143031025</td><td>0.007769293467685913</td></tr>\n</table></div>","text/plain":"<QTable length=1791>\n  id       xcenter       ...   instrumental_mag    e_instrumental_mag \n             pix         ...                                          \nint64      float64       ...       float64              float64       \n----- ------------------ ... ------------------- ---------------------\n    1  450.1709193760241 ...  -6.297237965583777  0.009050261160553049\n    2 478.89419941776816 ...  -6.504723707601205  0.007634322616347668\n    3  949.8117754685048 ...  -6.794881288928362  0.005973396056649387\n    4  165.2496454298732 ... -7.7143507252287495 0.0030426273698400627\n    5  1071.249859368704 ...  -7.624919288648352  0.003246909677336753\n    6 348.04474005431854 ... -7.8507643091164105 0.0028667696088001404\n    7 1034.1174172270996 ...  -7.812382767826401 0.0029756544787159053\n    8 1049.4292719479813 ...  -7.964164969893959  0.002645059307645637\n    9 1076.5677709563297 ...  -7.876122074465394 0.0027065865063203172\n  ...                ... ...                 ...                   ...\n 1782  584.0272762704734 ...  -7.945629268376205 0.0025488882951212872\n 1783  739.4645226601071 ...  -7.490989367948048 0.0035532636444281264\n 1784 1055.1906322987409 ...  -7.570298579134917 0.0033555098749846325\n 1785  556.6605923426521 ...  -6.581288459450731  0.007166964243179881\n 1786  943.6319852764369 ...  -7.134724760783715  0.004632166993233486\n 1787  975.4491612420895 ...  -7.927049072639981  0.002534172153090188\n 1788  664.5833217332253 ...  -6.225549301518787   0.00960390518834317\n 1789  709.9082904039421 ...  -6.377590504355184  0.008425324467484849\n 1790  787.7168148092121 ...   -6.59310443581128  0.007051192979946416\n 1791   883.970793036267 ... -6.4785451143031025  0.007769293467685913"},"exec_count":14}},"pos":26,"scrolled":true,"start":1734622290589,"state":"done","type":"cell"}
{"cell_type":"code","end":1734622291138,"exec_count":15,"id":"0602ae","input":"xmatch = XMatch.query(cat1=V300, cat2='vizier:II/336/apass9', max_distance=2*u.arcsec, colRA1='RA', colDec1='DEC')","kernel":"python3","last":324,"pos":29,"start":1734622290611,"state":"done","type":"cell"}
{"cell_type":"code","end":1734622291152,"exec_count":16,"id":"ae8d9b","input":"delta_mag = xmatch['Vmag'] - xmatch['instrumental_mag']","kernel":"python3","last":5,"pos":31,"start":1734622291151,"state":"done","type":"cell"}
{"cell_type":"code","end":1734622632093,"exec_count":21,"id":"5b6c23","input":"import matplotlib.pyplot as plt\nplt.scatter(xmatch['Vmag'], delta_mag)\nplt.xlabel(\"calibrated V-band magnitude\")\nplt.ylabel(\"V mag - instrumental mag\")\nplt.title(\"Difference in V mag and instrumental mag against calibrated V mag\")\nplt.axhline(21.2)\nplt.grid()","kernel":"python3","last":923,"output":{"0":{"data":{"image/png":"f11066bc53a5252e644052e7fccb6552614b7d20","text/plain":"<Figure size 864x504 with 1 Axes>"},"metadata":{"image/png":{"height":440,"width":726},"needs_background":"light"}}},"pos":33,"start":1734622631283,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"131dfd","input":"<section class=\"challenge panel panel-success\"> \n<div class=\"panel-heading\">\n<h2><span class=\"fa fa-question\"></span>Cross-matching your V and B-band tables (2 points)<h2>\n</div>\n</section>\n\n> Create ```SkyCoord``` objects from your 300s B and V tables. Match them using ```match_coordinates_sky```, and use a mask to remove all rows where there is no good match.","pos":44,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"2a6b89","input":"<section class=\"challenge panel panel-success\"> \n<div class=\"panel-heading\">\n<h2><span class=\"fa fa-pencil\"></span>Creating a Source List</h2>\n</div>\n</section>\n\nOur first job is to detect our sources. We will do this using an algorithm called DAOFIND ([Stetson 1987, PASP, 99, 191](https://ui.adsabs.harvard.edu/abs/1987PASP...99..191S/abstract)). DAOFIND looks for bright regions in the image that have a peak brightness greater than some threshold and that have a size and shape similar to a Gaussian of specified FWHM.\n\nStars in our image will stand out above the background, and DAOFIND will find them, but we need to know what threshold to use. One way of doing this is to measure the statistics of the **background** in our image. If we measure the average value of the background, and the amount the background varies, we can look for regions that are significantly brighter than background pixels. \n\nBelow I do that using a \"sigma-clipped\" mean - where I estimate the average background and the standard deviation. We then throw away all the pixels more than 3 standard deviations (sigma) away from the mean, and repeat the process. I carry on until no pixels are more than 3 standard deviations away from the average value. Then I calculate the mean, median and standard deviation of the remaining pixels. Sound complex? Don't worrry, there's already code to to it!","pos":11,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"3015d2","input":"---------\n<section class=\"challenge panel panel-success\"> \n<div class=\"panel-heading\">\n<h1>Homework #6</h1>\n<h2><span class=\"fa fa-pencil\"></span>The B-band data and making a CMD</h2>\n</div>\n</section>\n\n> Your task in the homework is to repeat the steps above for the rest of your data, and make two CMDs, one for the 30s data, and one for the 300s data.\n\n<section class=\"challenge panel panel-success\"> \n<div class=\"panel-heading\">\n<h2><span class=\"fa fa-question\"></span>  The B-band data (4 points)</h2>\n</div>\n</section>\n\n> Repeat the steps above for the 300-second B-band data. Make a plot of the difference between instrumental B-band magnitude and APASS B-band magnitude. Calculate the offset needed to correct your instrumental mags (zeropoint) and display it on your plot.\n\n> Finally, add your zeropoint to the **instrumental_mag** column of the 300s B-band table to make a new **calibrated_mag** column.","pos":37,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"38b6bf","input":"The result of this query (```xmatch```) is also an astropy ```Table```. It has all the columns from both tables for each valid match. If you want to extract a column and save it into a variable, you can access the ```Table``` like a dictionary. So the code below extracts the **Magnitude** column (which is instrumental magnitude from our APT photometry) and **Vmag** column from UCAC4 and computes the difference.","pos":30,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"3cffb9","input":"The ``sources`` variable contains a table of all the detected stars. There are various columns, but the ones we are interested in is the X and Y positions of the stars, which you can find with ```sources['xcentroid']``` and ```sources['ycentroid']```.\n\nBut how do we know we've found most of the stars? Or if we are mistakenly identifying bright background pixels as stars? We can inspect our sources by-eye. To make this easier, I've written a little helper function to plot your image with the sources overlaid. The function is in the file `photometry_helpers.py`","pos":15,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"47681a","input":"# Photometric Calibration\n\nNow we have a table of instrumental magnitudes (and much besides) in it. The next step is photometric calibration. As a reminder, this involves fitting a straight line to a graph of *instrumental magnitude* against *calibrated magnitude*, to find the offset between the two. Equivalently, we can find the average value of the *difference* between the calibrated and instrumental magnitudes for all our stars.\n\nSince we have instrumental magnitudes and sky positions (RA, Dec) for a number of stars, we must find the matching stars in an online catalog of calibrated magnitudes. We will use the [APASS](https://www.aavso.org/apass) catalog; a catalog which combines several other sky surveys to provide data in many filters across much of the sky. Crucially, in this case it includes B and V magnitudes, the two filters used for our photometry.\n\nTo perform the cross-matching we will use the [astroquery](https://astroquery.readthedocs.io/en/latest/) Python library, and we have our aperture photometry results in a [Table](http://docs.astropy.org/en/stable/table/) object from [astropy](http://www.astropy.org). ","pos":23,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"501a2e","input":"<section class=\"challenge panel panel-success\"> \n<div class=\"panel-heading\">\n<h2><span class=\"fa fa-pencil\"></span>Calculate the zero-point</h2>\n</div>\n</section>\n\n> Calculate the median value of ```delta_mag```. **If you have evidence for saturated stars**, use a NumPy *mask* to only calculate the median of stars that are not saturated (see notes on Fancy slicing in the NumPy notebook).\n\n> The median value of ```delta_mag``` is our estimate of $-kX + m_{\\rm zp}$ - i.e the value we want to add to our instrumental magnitudes to get a calibrated magnitude. You can add this value to the **instrumental_mag** column of the V300 table easily using ```V300['calibrated_mag'] = V300['instrumental_mag'] + zp```, where ```zp``` is the median value you found.","pos":35,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"516283","input":"Now you should have a two astropy tables in computer memory. One with corrected (calibrated) V-band magnitudes and one with corrected (calibrated) B-band magnitudes. We need to cross-match these tables with each other, to find which stars in the V-band table match with stars in the B-band table. We can't use ```astroquery```'s Xmatch for this, since they are both local tables. Instead, we will use the ```SkyCoord``` object from astropy, which is meant to work with coordinates on the sky. You can create a ```SkyCoord``` object with positions of all of the stars in a table like so:\n\n```python\nfrom astropy.coordinates import SkyCoord\n\ncoo_v = SkyCoord(V300['RA'], V300['DEC'], unit=u.deg)\n```\n\nThe ```SkyCoord``` you made is a bit like a NumPy array, but it is an array of positions on the sky. It carries within it several useful functions, including one to match positions against another sky coordinate object - ```match_coordinates_sky```. It's usage is shown below, and the documentation is [here](http://docs.astropy.org/en/stable/coordinates/matchsep.html#matching-catalogs). ```match_coordinates_sky``` returns an array of indices and the 2D and 3D separations of the matches. The array of indices can be used as a slice to sort the second set of coordinates, or the table from which it came, so that each row of the sorted coordinate/table contains the closest match of the corresponding row. Perhaps an example will explain:\n\n```python\n# match every entry in coo_v with the nearest entry in coo_v\nidx, distance_2d, distance_3d = coo_v.match_to_catalog_sky(coo_b)\n\n# using idx as a slice for the table B300 will sort it so that B300[0] is the closest match to V300[0]\nB300 = B300[idx]\n```\n\nWe are not quite done yet though - we have found the closest match to every object in the V300 table, but some of those matches may be quite far away. We could create a *fancy slicing mask* of True and False values by comparing the ```distance_2d``` array to some threshold separation, and use that mask to remove the rows where there is no close cross-match:\n\n```python\nmask = distance_2d < 3 * u.arcsec\nB300 = B300[mask]\nV300 = V300[mask]\n```\n\n","pos":43,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"529b1d","input":"The magnitude difference between instrumental and calibrated magnitude *should* be a constant, which is the value of $kX + m_{\\rm zp}$. In the figure above, you can see there are plenty of outlying points, and the bright stars deviate from the constant. The outliers are either stars whose photometry is bad (poor sky estimation, or contaminated by very close stars), or spurious detections (i.e not stars). The deviation of the bright stars is caused because they are [saturated](http://slittlefair.staff.shef.ac.uk/teaching/phy241/lectures/L06/index.html#readout), and so we cannot accurately measure their flux.\n\nSince $m = m_i - kX + m_{\\rm zp}$, we can find the value of $-kX + m_{\\rm zp}$. - which I'll call the *zeropoint* from now on - by calculating the **median** difference between the instrumental and calibrated magnitude. The median will be robust against the outliers - but we only want to do it for the non-saturated stars!","pos":34,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"57a07d","input":"<section class=\"challenge panel panel-success\"> \n<div class=\"panel-heading\">\n<h2><span class=\"fa fa-pencil\"></span>Tweak the detection settings</h2>\n</div>\n</section>\n\n> The DAOFIND algorithm requires a threshold for star detection, and a typical FWHM of the stars in the images. Try different settings for these values, and see how they affect the detection of stars in your data. Make a decision about what values to use for this image.\n\n<section class=\"challenge panel panel-success\"> \n<div class=\"panel-heading\">\n<h2><span class=\"fa fa-pencil\"></span>FWHM of stars in the image</h2>\n</div>\n</section>\n\nWe will also need an estimate for the FWHM of stars in the image. We can estimate this by-eye by plotting a bright, isolated, star and plotting the brightness against distance from the star's centre. I've written a clever little routine to do this. \n\nUsing the plot created by the code below, estimate the FWHM of the star in pixels. You should be able to convert this to a value in arcseconds, using the information you recorded during observing, and the specifications of the [Hicks Observatory](https://sites.google.com/sheffield.ac.uk/astronomy/hicks-observatory)","pos":17,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"5ffe8c","input":"<section class=\"challenge panel panel-success\"> \n<div class=\"panel-heading\">\n<h2><span class=\"fa fa-pencil\"></span>Perform Aperture Photometry</h2>\n</div>\n</section>\n\nUsing the help above, use this function to perform aperture photometry on all of your sources. You'll need to pick values for the aperture radii, remembering everything we've discussed in the course about how these choices affect the quality of your measurement. \n\nTarget apertures want to be big enough to accept a decent fraction of the flux, but not so large that the measurements are very noisy, or contaminated by nearby stars. As a rule of thumb this aperture might have a radius of 1.5-2x the FWHM.\n\nSky Annuli want to be wide enough to accurately measure the sky, but not so large that the annuli overlap nearby stars.\n\nTo get started, try values around 5, 10, 20 pixels for these apertures. We will tweak them later on.","pos":21,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"603cb2","input":"# Finding Stars\n\nNow we know how bright our background is, and how much it varies, let's look for stars that are brighter than the background plus 5 standard deviations. That should be enough that we don't identify bright background pixels as stars by accident. The DAOFIND algorithm needs a guess for how big the stars are - as a Gaussian FWHM - we'll guess at 3 pixels for now.","pos":13,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"6c715d","input":"# Aperture Photometry\n\nSo, we have a list of detected sources and positions in the image, and an idea of the FWHM of stars in the image. Now we can perform aperture photometry on all of these sources. I've written a function to do this for us. The comments in the function make it relatively easy to understand, so by all means take a look in the file `photometry_helpers.py` to see what the function does if you like. In brief the function performs the following steps:\n\n1. Add up the counts from each source within a target aperture\n2. Measure the sky brightness around each source using the sky annulus\n3. Subtract the sky contribution from the counts in step 1.\n4. Calculate instrumental magnitude from the counts and exposure time.\n\nBy now you should be getting quite good at reading documentation for functions you import, so let's import my function at look at the documentation.","pos":19,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"6e3d55","input":"The cell above should install photutils into a directory within our project. The directory should be something like `/home/user/.local/lib/python3.10/site-packages`.\n\n**If the code cell below raises an error** edit the code cell below, so the path in the call to `sys.path.append` is the same one as the install location for photutils. Ask a demonstrator to help you find out where this is.","pos":6,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"744e70","input":"<section class=\"challenge panel panel-success\"> \n<div class=\"panel-heading\">\n<h2><span class=\"fa fa-pencil\"></span>Read in your image</h2>\n</div>\n</section>\n\nUsing the code cell below, read in your 300s, V-band stacked image into an array called `data`. Read the header from the FITS file into a variable called `header`. It's important to use those variable names - I'll assume they exist later in the notebook.\n\nYou can look at the code from Session 5 about the `astropy.io.fits` library if you can't remember how to do this.","pos":9,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"7c35b0","input":"<section class=\"objectives panel panel-warning\">\n<div class=\"panel-heading\">\n<h2><span class=\"fa fa-certificate\"></span>&nbsp;Learning Objectives</h2>\n</div>\n</section>\n\n> * How to use the ``photutils`` library to detect sources on an image, and measure instrumental magnitudes for many stars\n> * Use the ```astroquery``` and ```astropy``` librarys to cross match catalogs on sky position\n> * How to compute zeropoints and uncertainties","pos":2,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"7f4384","input":"<section class=\"challenge panel panel-success\"> \n<div class=\"panel-heading\">\n<h2><span class=\"fa fa-pencil\"></span>X-match with APASS</h2>\n</div>\n</section>\n\n> We need to calibrate our photometry, which will involve comparing our instrumental magnitudes to calibrated magnitudes measured for the same stars. We need to match our detected stars with those catalogued in the sky survey [APASS](https://www.aavso.org/apass). We are looking for stars who's RA and Dec matches to within some radius. A service called **Vizier** hosts online versions of astronomical catalogs, and we can use the ```Xmatch.query``` function to match an astropy table with a table hosted by Vizier using the code below.\n\n> Run the code cell below, and note carefully how we specify the columns that contain RA and Dec in our *local* table, and how we set the maximum distance for a valid match. **II/336/apass9** is the name of the APASS catalog on Vizier. If you need to find the names of other catalogs (perhaps APASS doesn't cover the patch of sky containing your open cluster), you can enter the catalog name in the search box [here](http://vizier.u-strasbg.fr)\n\n> **The code cell below may take a while to run. Be patient...**","pos":28,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"8f5e33","input":"In the [lecture](http://slittlefair.staff.shef.ac.uk/teaching/phy241/lectures/L07/index.html) we learnt the theory behind precise calibration of photometry, enabling us to put photometric observations onto a standard scale with precisions of better than 1%. In this practical we are going to learn how to produce calibrated photometry using a **simplified method**. This method does not yield the same accuracy as an analysis using observations of primary or secondary standard stars, combined with the use of colour terms. On the other hand, it is much simpler to apply, and even works to produce calibrated photometry through thin cloud. If you are happy to accept accuracies on the order of a few percent, I recommend using the method described below whenever you need to produce calibrated photometry. \n\nIn this practical we will will produce a colour-magnitude diagrams using the stacked images you made of your open cluster in the previous practical. If you have not yet finished that practical, use the stacked images provided in the ```data``` folder, taken from the open cluster NGC 7789. If you have finished, upload your own stacked images to the ```data``` folder and use them instead.\n\n## Method\n\nIn the lecture we saw that, for any star, the difference between the calibrated magnitude, $m$ and the above-atmosphere instrumental magnitude $m_{0,i}$ is given by:\n$$m = m_{0,i} + m_{\\rm zp},$$\nwhere $m_{\\rm zp}$ is known as the zero point. The above-atmosphere instrumental magnitude is given by:\n$$m_{0,i} = m_i - kX,$$\nwhere $m_i = -2.5 \\log_{10} \\left( N_t/t_{\\rm exp} \\right)$ is the instrumental magnitude, $k$ is the extinction coefficient, and $X$ is the airmass. Therefore:\n$$m = m_i - kX + m_{\\rm zp}.$$\nIn other words, if we were to plot the calibrated magnitude $m$ against instrumental magnitude $m_i$ for all the stars in our image, we would expect a straight line, with a gradient of one, and an intercept equal to $ -kX + m_{\\rm zp} $. **This intercept could then be added to all of our instrumental magnitudes to produce calibrated magnitudes.**\n\nWhat makes this technique possible, is the existence of large sky surveys, which have provided calibrated magnitudes for many, relatively bright stars over a very wide areas of the sky. If your data is covered by one of these surveys, and it provides calibrated magnitudes in the same filter as your data, you can apply this technique relatively quickly.\n\n## Accuracy\n\nThe accuracy this technique can achieve is limited by two factors. First of all we are not taking into account any secondary effects, such as 2nd-order extinction, or colour terms. Secondly, our photometry cannot be any more accurate than that in the sky survey we use. Typically, large sky surveys achieve accuracies of a few percent. Ignoring the secondary effects will probably introduce errors on a similar level. If you need calibrated photometry to better than a few percent, you will have to observe standard stars, and apply the rigorous method described in the lecture.\n\n## Steps\n\nApplying this method requires the application of four steps. These steps are:\n\n1. finding the stars in our image, and calculating instrumental magnitudes;\n1. matching our stars against a sky-survey, so we know instrumental and calibrated magnitude for many stars;\n1. calculating the offset between instrumental and calibrated magnitudes, and applying to all stars in our image.\n\n\nWe will carry out these steps in Python. As usual we will draw on several third-party Python libraries. I will explain their use, and provide links to detailed documentation. We will also use some code that I have written which will help ease the code writing.","pos":3,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"97bdda","input":"# Photometry with Photutils\n\nWe have done aperture photometry [before](http://slittlefair.staff.shef.ac.uk/teaching/phy241/practicals/P05/index.html), using AstroImageJ. Whilst this tool is excellent for relative photometry, and producing light curves, each aperture must be placed by hand, which makes it onerous to use when we want to measure every star in an image. \n\nThere are a lot of steps to aperture photometry. We must detect stars in the image, and measure their positions accurately. Then we have to add up the counts within a *target aperture*. Finally we have to measure the sky background level in a *sky annulus*, and subtract off the sky background. You can imagine that writing the functions to do this from scratch is going to be hard. Thankfully, there is a Python library called [photutils](http://photutils.readthedocs.org/en/latest/) that is written to do exactly this. \n\nPhotutils is not installed by default on CoCalc. The code cell below will install it. Run this cell, and if there are any **errors**, ask for help (warnings are ok).","pos":4,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"9d6e4c","input":"<section class=\"challenge panel panel-success\"> \n<div class=\"panel-heading\">\n<h2><span class=\"fa fa-question\"></span>Plotting your CMD (3 points)</h2>\n</div>\n</section>\n\n> With your matched tables in hand, extract the calibrated magnitude columns from each into two arrays called ```V``` and ```B```. Calculate ```B-V``` and plot a colour-magnitude diagram of ```B-V``` against ```V```. Your plot should look something like the one below, which is for the cluster NGC 7789.\n\n<img src=\"../../images/CMD.png\" style=\"margin: 0px\" width=750px/>\n\n> Also calculate error bars on ```B-V```: remember that $\\Delta (x+y)^2 = \\Delta x^2 + \\Delta y^2$\n\n> Hint: you can reverse the y-axis with ```plt.gca().invert_yaxis()```","pos":46,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"a8ccdf","input":"The important columns for our uses are the measured centres of our stars in RA and Dec (**RA** and **DEC**) and the instrumental magnitude and uncertainty (**instrumental_mag** and **e_instrumental_mag**). Note that the magnitude uncertainty is calculated using the CCD signal-to-noise equation we saw in the [lectures](http://slittlefair.staff.shef.ac.uk/teaching/phy241/lectures/L09/index.html).","pos":27,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"aa25f1","input":"<section class=\"challenge panel panel-success\"> \n<div class=\"panel-heading\">\n<h2><span class=\"fa fa-pencil\"></span>Plot the difference and find the zero-point</h2>\n</div>\n</section>\n\n> Plot the difference between instrumental and calibrated magnitude found above, against the calibrated V-band magnitude on the X-axis. You should see something like the figure below:\n\n<img src=\"../../images/V_zeropoint.png\" style=\"margin: 0px\" width=750px/>","pos":32,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"bd1523","input":"<section class=\"challenge panel panel-success\"> \n<div class=\"panel-heading\">\n<h2><span class=\"fa fa-question\"></span>Save your data (1 point)</h2>\n</div>\n</section>\n\n> Save your ```V``` and ```B-V``` data, along with their uncertainties, to a text file, for use in the next lab!\n\n> You might want to revisit Session1 for instructions for writing data to a file. Or, you could create an astropy Table using the instructions [here](https://docs.astropy.org/en/stable/table/construct_table.html) and [here](https://docs.astropy.org/en/stable/table/io.html)\n","pos":48,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"e02e1c","input":"# Absolute Photometry","pos":1,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"ef74b2","input":"Our photometry is stored as an astropy table, which is a handy object for reading and writing tabular data. These astropy tables play nicely with Jupyter notebooks, so you can simply type the name of the table in a code cell to see the table displayed in the browser. So, if you named your photometry table above ```V300``` the following cell will work. If not, replace the variable name below:","pos":25,"state":"done","type":"cell"}
{"end":1734529093075,"exec_count":19,"id":"509ddf","input":"def create_table_data(image_data, image_header):\n    \"\"\"\n    A function that reads in FITS image and header data and creates a sources plot, FWHM plot, and returns a table of data \n    \n    Parameters\n    ---------------\n    data: FITS image data\n    \n    header: FITS header data \n    \n    filtermag: Filter column magnitude\n    String value of either 'Bmag' or Vmag\n    Returns\n    ----------------\n    Table of photometry data \n   \n    \"\"\"    \n    mean_background, median_background, background_standard_deviation = sigma_clipped_stats(image_data, sigma=3.0)\n    print(f\"The background has an average value of {mean_background:.1f} and a standard deviation of {background_standard_deviation:.1f} counts\")\n    \n    #Create  sources\n    image_sources = daofind(image_data - median_background)\n\n    #Plot B300 sources\n    plot_sources(image_data, image_sources, 3)\n    measure_FWHM(image_data, image_sources)\n\n    #Create  table\n    table = aperture_photometry(image_data, image_header, image_sources, 5, 10, 20)\n    \n    return \n    table","kernel":"python3","last":4,"pos":38,"start":1734529093071,"state":"done","type":"cell"}
{"end":1734529093226,"exec_count":20,"id":"e94972","input":"#Read in B_300, B_30 and V_30 files\nB_300 = '../../observing_project/B_300_calib'\nV_30 = '../../observing_project/V_30_calib'\nB_30 = '../../observing_project/B_30_calib'\n\nfile_list = [B_300, V_30, B_30]\n\n\n#Create data and header objects of files\nB_300_data = fits.getdata(B_300)\nB_300_header  = fits.getheader(B_300)\n\nB_30_data = fits.getdata(B_30)\nB_30_header  = fits.getheader(B_30)\n\nV_30_data = fits.getdata(V_30)\nV_30_header  = fits.getheader(V_30)\n","kernel":"python3","last":48,"pos":39,"start":1734529093082,"state":"done","type":"cell"}
{"end":1734529105333,"exec_count":22,"id":"463fa0","input":"mean_background, median_background, background_standard_deviation = sigma_clipped_stats(B_30_data, sigma=3.0)\nprint(\"The background has an average value of {:.1f} and a standard deviation of {:.1f} counts\".format(mean_background, background_standard_deviation))\n\n#Create B30 sources\nB_30_sources = daofind(B_30_data - median_background)\n\n#Plot B30 sources\nplot_sources(B_30_data, B_30_sources, 3)\nmeasure_FWHM(B_30_data, B_30_sources)\n\n#Create B30 table\nB30 = aperture_photometry(B_30_data, B_30_header, B_30_sources, 5, 10, 20) ","kernel":"python3","last":3370,"output":{"0":{"name":"stdout","text":"The background has an average value of 486.9 and a standard deviation of 13.0 counts\n"},"1":{"data":{"image/png":"31791e966dae76d708d6fbfe10ab5d29285c5a75","text/plain":"<Figure size 1080x864 with 1 Axes>"},"metadata":{"image/png":{"height":595,"width":877},"needs_background":"light"}},"2":{"data":{"image/png":"170c8106e8195bd8e99f107f0b56ed0351713702","text/plain":"<Figure size 936x432 with 2 Axes>"},"metadata":{"image/png":{"height":372,"width":771},"needs_background":"light"}}},"pos":40.5,"start":1734529101681,"state":"done","type":"cell"}
{"end":1734529111328,"exec_count":23,"id":"0d3fe0","input":"mean_background, median_background, background_standard_deviation = sigma_clipped_stats(V_30_data, sigma=3.0)\nprint(\"The background has an average value of {:.1f} and a standard deviation of {:.1f} counts\".format(mean_background, background_standard_deviation))\n\n#Create V30 sources\nV_30_sources = daofind(V_30_data - median_background)\n\n#Plot V30 sources\nplot_sources(V_30_data, V_30_sources, 3)\nmeasure_FWHM(V_30_data, V_30_sources)\n\n#Create V30 table\nV30 = aperture_photometry(V_30_data, V_30_header, V_30_sources, 5, 10, 20) \nV30","kernel":"python3","last":6118,"output":{"0":{"name":"stdout","text":"The background has an average value of 1311.3 and a standard deviation of 20.2 counts\n"},"1":{"data":{"text/html":"<div><i>QTable length=746</i>\n<table id=\"table139728156475744\" class=\"table-striped table-bordered table-condensed\">\n<thead><tr><th>id</th><th>xcenter</th><th>ycenter</th><th>aperture_sum</th><th>aperture_sum_err</th><th>sky_mean</th><th>aper_bkg</th><th>aper_sum_bksub</th><th>RA</th><th>DEC</th><th>instrumental_mag</th><th>e_instrumental_mag</th></tr></thead>\n<thead><tr><th></th><th>pix</th><th>pix</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead>\n<thead><tr><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>\n<tr><td>1</td><td>950.0375204773163</td><td>0.3886256633949748</td><td>70576.65220200509</td><td>314.12953307187405</td><td>680.1788049133763</td><td>53421.11841608371</td><td>17155.533785921383</td><td>359.5552624522192</td><td>56.62026752584726</td><td>-6.893207451850175</td><td>0.018310682546623127</td></tr>\n<tr><td>2</td><td>348.2575482264078</td><td>7.20286579499571</td><td>113184.43698825758</td><td>398.05715197770735</td><td>879.2005020425461</td><td>69052.24595623302</td><td>44132.191032024566</td><td>359.25798237777065</td><td>56.62042794083401</td><td>-7.919085586730262</td><td>0.009019655327986249</td></tr>\n<tr><td>3</td><td>1049.5748779071414</td><td>7.336683069002547</td><td>117661.55385253901</td><td>405.30204533247036</td><td>893.6480072795927</td><td>70186.95036411817</td><td>47474.60348842085</td><td>359.6044036312153</td><td>56.62236707578502</td><td>-7.99835022860816</td><td>0.008537239187923377</td></tr>\n<tr><td>4</td><td>231.9442484946911</td><td>8.10643597515521</td><td>112593.29345017544</td><td>397.0906819220072</td><td>913.479375797477</td><td>71744.50240527859</td><td>40848.79104489685</td><td>359.20052621996155</td><td>56.62026486579352</td><td>-7.835144882550654</td><td>0.009720989820373518</td></tr>\n<tr><td>5</td><td>269.14054386541005</td><td>7.875793062418203</td><td>114455.97692332344</td><td>400.1281021067595</td><td>923.3236220869751</td><td>72517.66770085899</td><td>41938.30922246445</td><td>359.2188999147855</td><td>56.620335740702025</td><td>-7.863724157055661</td><td>0.009540873476425918</td></tr>\n<tr><td>6</td><td>473.6569056154273</td><td>7.928820358868076</td><td>120118.34787845405</td><td>409.22314214524124</td><td>904.1844801484151</td><td>71014.48300810417</td><td>49103.86487034988</td><td>359.3199176714754</td><td>56.62103607988119</td><td>-8.034986053070845</td><td>0.008333827555646038</td></tr>\n<tr><td>7</td><td>1034.3366890733703</td><td>7.6769017506455715</td><td>112572.81993986912</td><td>397.05716730322695</td><td>911.5022030421628</td><td>71589.21562020427</td><td>40983.60431966485</td><td>359.5968750075038</td><td>56.62242841233987</td><td>-7.83872223807263</td><td>0.009688195411175927</td></tr>\n<tr><td>8</td><td>392.34433142386496</td><td>8.98861163322726</td><td>113511.04548461996</td><td>398.59012440137144</td><td>946.4484850001877</td><td>74333.89018694448</td><td>39177.155297675476</td><td>359.2797475836486</td><td>56.62106114349185</td><td>-7.789779108543753</td><td>0.01017404457707069</td></tr>\n<tr><td>9</td><td>922.9993562094179</td><td>9.779954313591224</td><td>109700.17232360148</td><td>392.3263339908416</td><td>979.5350299610815</td><td>76932.50135148979</td><td>32767.670972111693</td><td>359.5418681431827</td><td>56.62275876686251</td><td>-7.595810798522372</td><td>0.011972969770257625</td></tr>\n<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>\n<tr><td>737</td><td>516.5839970779413</td><td>723.6676706404902</td><td>107917.82240360943</td><td>389.36216756599856</td><td>1060.1264015458635</td><td>83262.1328743267</td><td>24655.68952928274</td><td>359.3371072037691</td><td>56.81566170164541</td><td>-7.2869897448561805</td><td>0.01579198047183252</td></tr>\n<tr><td>738</td><td>598.3253210339549</td><td>725.9052524855992</td><td>117727.37328949747</td><td>405.40758899605135</td><td>969.6514912596133</td><td>76156.25003708972</td><td>41571.12325240775</td><td>359.3776808864502</td><td>56.81651539903361</td><td>-7.8541762614721495</td><td>0.00975214421160897</td></tr>\n<tr><td>739</td><td>919.5268790223649</td><td>726.3737662778605</td><td>114724.32652236769</td><td>400.5637933731893</td><td>924.1307216184692</td><td>72581.05714983043</td><td>42143.26937253725</td><td>359.53716684971346</td><td>56.81748050776939</td><td>-7.869017423427543</td><td>0.009504810598159656</td></tr>\n<tr><td>740</td><td>618.8546321457404</td><td>727.4408633870071</td><td>109610.51313396962</td><td>392.1777599513353</td><td>904.3419721770119</td><td>71026.85240310515</td><td>38583.660730864474</td><td>359.387866112997</td><td>56.81699231241317</td><td>-7.773205438564325</td><td>0.01016434813396589</td></tr>\n<tr><td>741</td><td>988.8339125882317</td><td>728.5468315596688</td><td>113752.69162175083</td><td>398.9839937103346</td><td>879.6763658964082</td><td>69089.62021591808</td><td>44663.07140583274</td><td>359.5715725913825</td><td>56.81822512506191</td><td>-7.932068326896698</td><td>0.008933196512280826</td></tr>\n<tr><td>742</td><td>1009.3390949044366</td><td>729.2775333036888</td><td>109975.63166179138</td><td>392.7824454697604</td><td>829.8520634575086</td><td>65176.428653111</td><td>44799.203008680386</td><td>359.58175178871</td><td>56.81846746649151</td><td>-7.935372582793799</td><td>0.008767621276513649</td></tr>\n<tr><td>743</td><td>859.6621458555715</td><td>731.7100382015727</td><td>117815.5569350761</td><td>404.5884209131757</td><td>757.9723267743426</td><td>59531.007335465925</td><td>58284.54959961018</td><td>359.5074178083092</td><td>56.81878986929828</td><td>-8.221080475101829</td><td>0.0069416067155451035</td></tr>\n<tr><td>744</td><td>464.49855099018265</td><td>733.2520653158518</td><td>91576.48948542349</td><td>357.5314028098131</td><td>718.0305699423714</td><td>56393.98908959615</td><td>35182.50039582734</td><td>359.3111905497413</td><td>56.81810270427467</td><td>-7.673013616263269</td><td>0.010162194238253075</td></tr>\n<tr><td>745</td><td>584.4209133299304</td><td>733.4406664489132</td><td>99764.05041577287</td><td>371.7895284710589</td><td>732.6038851548649</td><td>57538.574589846605</td><td>42225.47582592627</td><td>359.37073637023207</td><td>56.8185221898735</td><td>-7.871133243705428</td><td>0.008804862969543652</td></tr>\n<tr><td>746</td><td>975.8931487808844</td><td>734.6889077174031</td><td>92037.36838864454</td><td>355.6209657302751</td><td>685.0452096168808</td><td>53803.32494773182</td><td>38234.04344091272</td><td>359.5651222730994</td><td>56.81986614037993</td><td>-7.7633224363427</td><td>0.00930116026780833</td></tr>\n</table></div>","text/plain":"<QTable length=746>\n  id       xcenter       ...   instrumental_mag    e_instrumental_mag \n             pix         ...                                          \nint64      float64       ...       float64              float64       \n----- ------------------ ... ------------------- ---------------------\n    1  950.0375204773163 ...  -6.893207451850175  0.018310682546623127\n    2  348.2575482264078 ...  -7.919085586730262  0.009019655327986249\n    3 1049.5748779071414 ...   -7.99835022860816  0.008537239187923377\n    4  231.9442484946911 ...  -7.835144882550654  0.009720989820373518\n    5 269.14054386541005 ...  -7.863724157055661  0.009540873476425918\n    6  473.6569056154273 ...  -8.034986053070845  0.008333827555646038\n    7 1034.3366890733703 ...   -7.83872223807263  0.009688195411175927\n    8 392.34433142386496 ...  -7.789779108543753   0.01017404457707069\n    9  922.9993562094179 ...  -7.595810798522372  0.011972969770257625\n  ...                ... ...                 ...                   ...\n  737  516.5839970779413 ... -7.2869897448561805   0.01579198047183252\n  738  598.3253210339549 ... -7.8541762614721495   0.00975214421160897\n  739  919.5268790223649 ...  -7.869017423427543  0.009504810598159656\n  740  618.8546321457404 ...  -7.773205438564325   0.01016434813396589\n  741  988.8339125882317 ...  -7.932068326896698  0.008933196512280826\n  742 1009.3390949044366 ...  -7.935372582793799  0.008767621276513649\n  743  859.6621458555715 ...  -8.221080475101829 0.0069416067155451035\n  744 464.49855099018265 ...  -7.673013616263269  0.010162194238253075\n  745  584.4209133299304 ...  -7.871133243705428  0.008804862969543652\n  746  975.8931487808844 ...    -7.7633224363427   0.00930116026780833"},"exec_count":23},"2":{"data":{"image/png":"9c5064ca8fc8d9ffe07ff200829d1341ab60a6c7","text/plain":"<Figure size 1080x864 with 1 Axes>"},"metadata":{"image/png":{"height":595,"width":877},"needs_background":"light"}},"3":{"data":{"image/png":"e6b6cbe4bf5ec367b2d1cc9b35075ae0d1f54be2","text/plain":"<Figure size 936x432 with 2 Axes>"},"metadata":{"image/png":{"height":370,"width":771},"needs_background":"light"}}},"pos":40.75,"start":1734529105339,"state":"done","type":"cell"}
{"end":1734529112046,"exec_count":24,"id":"0fd2bd","input":"#B300 Xmatch\nB_300_xmatch = XMatch.query(cat1=B300, cat2='vizier:II/336/apass9', max_distance=2*u.arcsec, colRA1='RA', colDec1='DEC')\nB_300_delta_mag = B_300_xmatch['Bmag'] - B_300_xmatch['instrumental_mag']\nplt.scatter(B_300_xmatch['Bmag'], B_300_delta_mag)\nplt.xlabel(\"calibrated B-band mag\")\nplt.ylabel(\"Calibrated Mag\")\nplt.grid()","kernel":"python3","last":671,"output":{"0":{"data":{"image/png":"9c601fcf10c1dd15c0454372e38f411e0174456a","text/plain":"<Figure size 864x504 with 1 Axes>"},"metadata":{"image/png":{"height":424,"width":727},"needs_background":"light"}}},"pos":41,"start":1734529111345,"state":"done","type":"cell"}
{"end":1734529112596,"exec_count":25,"id":"18f92b","input":"#B30 Xmatch \nB_30_xmatch = XMatch.query(cat1=B30, cat2='vizier:II/336/apass9', max_distance=2*u.arcsec, colRA1='RA', colDec1='DEC')\nB_30_delta_mag = B_30_xmatch['Bmag'] - B_30_xmatch['instrumental_mag']\nplt.scatter(B_30_xmatch['Bmag'], B_30_delta_mag)\nplt.xlabel(\"calibrated B-band mag\")\nplt.ylabel(\"Calibrated Mag\")\nplt.grid()","kernel":"python3","last":593,"output":{"0":{"data":{"image/png":"f32c6baa8a50276b901d6b6615794f4ee92ed4e4","text/plain":"<Figure size 864x504 with 1 Axes>"},"metadata":{"image/png":{"height":424,"width":726},"needs_background":"light"}}},"pos":41.5,"start":1734529112058,"state":"done","type":"cell"}
{"end":1734529113295,"exec_count":26,"id":"a3460a","input":"#V30 Xmatch \nV_30_xmatch = XMatch.query(cat1=V30, cat2='vizier:II/336/apass9', max_distance=2*u.arcsec, colRA1='RA', colDec1='DEC')\nV_30_delta_mag = V_30_xmatch['Vmag'] - V_30_xmatch['instrumental_mag']\nplt.scatter(V_30_xmatch['Vmag'], V_30_delta_mag)\nplt.xlabel(\"calibrated V-band mag\")\nplt.ylabel(\"Calibrated Mag\")\nplt.grid()","kernel":"python3","last":560,"output":{"0":{"data":{"image/png":"55ea20e180381700251b11589dadf14cad5888f9","text/plain":"<Figure size 864x504 with 1 Axes>"},"metadata":{"image/png":{"height":424,"width":726},"needs_background":"light"}}},"pos":41.75,"start":1734529112617,"state":"done","type":"cell"}
{"end":1734529113314,"exec_count":27,"id":"79131e","input":"#B300 mask and Zero point calculation\nmask = (B_300_xmatch[\"Bmag\"] >= 12)\nmag = B_300_delta_mag\nZP = B_300_delta_mag[mask]\nZP_median_B300 = np.median(ZP)\nprint(f\"The median for the masked zero point is {ZP_median_B300}\")\nB300['calibrated_mag'] = B300['instrumental_mag'] + ZP_median_B300\nB300","kernel":"python3","last":5,"output":{"0":{"name":"stdout","text":"The median for the masked zero point is 20.64745921069452\n"},"1":{"name":"stderr","text":"/home/user/.local/lib/python3.10/site-packages/numpy/core/fromnumeric.py:771: UserWarning: Warning: 'partition' will ignore the 'mask' of the MaskedColumn.\n  a.partition(kth, axis=axis, kind=kind, order=order)\n"},"2":{"data":{"text/html":"<div><i>QTable length=937</i>\n<table id=\"table139728153215088\" class=\"table-striped table-bordered table-condensed\">\n<thead><tr><th>id</th><th>xcenter</th><th>ycenter</th><th>aperture_sum</th><th>aperture_sum_err</th><th>sky_mean</th><th>aper_bkg</th><th>aper_sum_bksub</th><th>RA</th><th>DEC</th><th>instrumental_mag</th><th>e_instrumental_mag</th><th>calibrated_mag</th></tr></thead>\n<thead><tr><th></th><th>pix</th><th>pix</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead>\n<thead><tr><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>\n<tr><td>1</td><td>950.2147251967295</td><td>1.485898374638976</td><td>326555.2732997457</td><td>657.9964478701512</td><td>2503.7183911951415</td><td>196641.58261090782</td><td>129913.69068883787</td><td>359.5553725233513</td><td>56.61982266034955</td><td>-6.591334165004127</td><td>0.005064873797220865</td><td>14.056125045690393</td></tr>\n<tr><td>2</td><td>231.86138793169647</td><td>10.404042913612098</td><td>394999.12990487966</td><td>724.4367353980889</td><td>3568.276290668575</td><td>280251.7645185758</td><td>114747.36538630386</td><td>359.2005665082538</td><td>56.62019475279378</td><td>-6.456553670372772</td><td>0.006313319115948583</td><td>14.190905540321749</td></tr>\n<tr><td>3</td><td>269.01762987183884</td><td>10.20132875908336</td><td>400222.7598597241</td><td>729.1085668722155</td><td>3605.993623927806</td><td>283214.0769455808</td><td>117008.68291414331</td><td>359.21891700646654</td><td>56.6202705631378</td><td>-6.477742090253852</td><td>0.006231234714497288</td><td>14.16971712044067</td></tr>\n<tr><td>4</td><td>348.14109184359</td><td>9.731975591992512</td><td>394417.94802605634</td><td>723.9150828512162</td><td>3428.029560962597</td><td>269236.81212521845</td><td>125181.1359008379</td><td>359.25799451231</td><td>56.62041275864772</td><td>-6.5510440833215995</td><td>0.005782940677456903</td><td>14.096415127372921</td></tr>\n<tr><td>5</td><td>473.6270941640233</td><td>10.300861715991967</td><td>416394.90737476543</td><td>743.3862342583847</td><td>3535.267949964973</td><td>277659.2955020352</td><td>138735.61187273025</td><td>359.31996280020957</td><td>56.620970223634274</td><td>-6.662666747943677</td><td>0.00535829427083461</td><td>13.984792462750843</td></tr>\n<tr><td>6</td><td>1034.5276765768167</td><td>10.101035770946819</td><td>394977.8477761071</td><td>724.417639782364</td><td>3578.9700851502394</td><td>281091.6531731407</td><td>113886.19460296637</td><td>359.5969801998982</td><td>56.62233983115448</td><td>-6.448374567359652</td><td>0.006360890732259968</td><td>14.199084643334869</td></tr>\n<tr><td>7</td><td>1049.7642041601173</td><td>9.85037545793739</td><td>410170.4310777228</td><td>737.9236236871079</td><td>3516.593476840213</td><td>276192.605812575</td><td>133977.82526514778</td><td>359.60450631345594</td><td>56.62230177299949</td><td>-6.62477917325646</td><td>0.005507804162567394</td><td>14.022680037438061</td></tr>\n<tr><td>8</td><td>392.31105736421193</td><td>11.324556484496693</td><td>397686.3100689307</td><td>726.8438055589194</td><td>3696.432478013892</td><td>290317.12793547893</td><td>107369.18213345174</td><td>359.27979836645443</td><td>56.620991050111805</td><td>-6.384395975594978</td><td>0.006769575693102586</td><td>14.263063235099544</td></tr>\n<tr><td>9</td><td>923.1579068919351</td><td>12.225317404118803</td><td>376785.1958700552</td><td>707.9056930251915</td><td>3859.296617821253</td><td>303108.4475642796</td><td>73676.74830577557</td><td>359.5419671855064</td><td>56.62268364354382</td><td>-5.975522988691102</td><td>0.009608264605913644</td><td>14.671936222003419</td></tr>\n<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>\n<tr><td>928</td><td>570.9020577555998</td><td>728.3761904969338</td><td>370647.10217435006</td><td>702.2470709840997</td><td>3073.6915953867815</td><td>241407.1733866951</td><td>129239.92878765496</td><td>359.3642001767637</td><td>56.81649904737039</td><td>-6.585688638314763</td><td>0.0054336695909041575</td><td>14.061770572379757</td></tr>\n<tr><td>929</td><td>598.3655001048936</td><td>728.0047413248208</td><td>414215.25736951246</td><td>741.4779486822025</td><td>3128.638454298276</td><td>245722.68959404973</td><td>168492.56777546272</td><td>359.3778360133726</td><td>56.816477281370894</td><td>-6.873648735339527</td><td>0.004400656708314363</td><td>13.773810475354994</td></tr>\n<tr><td>930</td><td>919.5118790099185</td><td>729.1539435257679</td><td>407047.48877159326</td><td>735.1676336363412</td><td>2973.304765100198</td><td>233522.8101730577</td><td>173524.67859853557</td><td>359.53726393012664</td><td>56.81760589932662</td><td>-6.905599984894016</td><td>0.004236674803687235</td><td>13.741859225800505</td></tr>\n<tr><td>931</td><td>618.7631915235065</td><td>730.0512337623923</td><td>384501.1381542795</td><td>714.9553796000445</td><td>2896.859111914023</td><td>227518.78261184366</td><td>156982.35554243583</td><td>359.3879516683372</td><td>56.817091585711744</td><td>-6.796823966816511</td><td>0.004554367764005019</td><td>13.85063524387801</td></tr>\n<tr><td>932</td><td>988.9238353040242</td><td>731.3308827327483</td><td>388579.15527845727</td><td>718.3414304309895</td><td>2790.4282371446884</td><td>219159.72125458176</td><td>169419.4340238755</td><td>359.57171612416585</td><td>56.818347496293796</td><td>-6.879604929622518</td><td>0.00424001788560902</td><td>13.767854281072003</td></tr>\n<tr><td>933</td><td>1009.4219089557361</td><td>732.0294338534825</td><td>344949.1708807939</td><td>677.2366300221502</td><td>2684.6329237068717</td><td>210850.5767675699</td><td>134098.59411322398</td><td>359.58189025825163</td><td>56.81857982124095</td><td>-6.625757425054495</td><td>0.005050288815484048</td><td>14.021701785640026</td></tr>\n<tr><td>934</td><td>349.94734406392547</td><td>734.4318931833117</td><td>237933.26204294586</td><td>562.5783415615706</td><td>2417.569384316503</td><td>189875.45543280814</td><td>48057.80661013772</td><td>359.25447504420157</td><td>56.8174540093133</td><td>-5.511606726787752</td><td>0.011706284186571585</td><td>15.135852483906769</td></tr>\n<tr><td>935</td><td>859.6763702547553</td><td>734.1062004813818</td><td>282440.56387415517</td><td>612.2159357453794</td><td>2447.461738883211</td><td>192223.19547043994</td><td>90217.36840371523</td><td>359.50753675234085</td><td>56.81881573172369</td><td>-6.195422250175633</td><td>0.006786009685028319</td><td>14.452036960518889</td></tr>\n<tr><td>936</td><td>464.465166337361</td><td>734.52832421987</td><td>243416.69937432755</td><td>568.7591052041475</td><td>2391.8365879131848</td><td>187854.40632938346</td><td>55562.29304494409</td><td>359.31132631090145</td><td>56.81785064215582</td><td>-5.669147264909799</td><td>0.010236422473494405</td><td>14.978311945784721</td></tr>\n<tr><td>937</td><td>584.3860002161774</td><td>734.5717509784375</td><td>251176.15241457484</td><td>577.5056822600939</td><td>2462.9955937575037</td><td>193443.2215793151</td><td>57732.93083525973</td><td>359.3708614256253</td><td>56.8182226430957</td><td>-5.710755876177972</td><td>0.010003054996601504</td><td>14.93670333451655</td></tr>\n</table></div>","text/plain":"<QTable length=937>\n  id       xcenter       ...   e_instrumental_mag    calibrated_mag  \n             pix         ...                                         \nint64      float64       ...        float64             float64      \n----- ------------------ ... --------------------- ------------------\n    1  950.2147251967295 ...  0.005064873797220865 14.056125045690393\n    2 231.86138793169647 ...  0.006313319115948583 14.190905540321749\n    3 269.01762987183884 ...  0.006231234714497288  14.16971712044067\n    4    348.14109184359 ...  0.005782940677456903 14.096415127372921\n    5  473.6270941640233 ...   0.00535829427083461 13.984792462750843\n    6 1034.5276765768167 ...  0.006360890732259968 14.199084643334869\n    7 1049.7642041601173 ...  0.005507804162567394 14.022680037438061\n    8 392.31105736421193 ...  0.006769575693102586 14.263063235099544\n    9  923.1579068919351 ...  0.009608264605913644 14.671936222003419\n  ...                ... ...                   ...                ...\n  928  570.9020577555998 ... 0.0054336695909041575 14.061770572379757\n  929  598.3655001048936 ...  0.004400656708314363 13.773810475354994\n  930  919.5118790099185 ...  0.004236674803687235 13.741859225800505\n  931  618.7631915235065 ...  0.004554367764005019  13.85063524387801\n  932  988.9238353040242 ...   0.00424001788560902 13.767854281072003\n  933 1009.4219089557361 ...  0.005050288815484048 14.021701785640026\n  934 349.94734406392547 ...  0.011706284186571585 15.135852483906769\n  935  859.6763702547553 ...  0.006786009685028319 14.452036960518889\n  936   464.465166337361 ...  0.010236422473494405 14.978311945784721\n  937  584.3860002161774 ...  0.010003054996601504  14.93670333451655"},"exec_count":27}},"pos":42,"start":1734529113302,"state":"done","type":"cell"}
{"end":1734529113332,"exec_count":28,"id":"905e25","input":"# B30 mask and Zero point calculation\nmask = (B_30_xmatch[\"Bmag\"] >= 11)\nmag = B_30_delta_mag\nZP = B_30_delta_mag[mask]\nZP_median_B30 = np.median(ZP)\nprint(f\"The median for the masked zero point is {ZP_median_B30}\")\nB30['calibrated_mag'] = B30['instrumental_mag'] + ZP_median_B30\nB30","kernel":"python3","last":7,"output":{"0":{"name":"stdout","text":"The median for the masked zero point is 20.64583731763862\n"},"1":{"data":{"text/html":"<div><i>QTable length=188</i>\n<table id=\"table139728144546544\" class=\"table-striped table-bordered table-condensed\">\n<thead><tr><th>id</th><th>xcenter</th><th>ycenter</th><th>aperture_sum</th><th>aperture_sum_err</th><th>sky_mean</th><th>aper_bkg</th><th>aper_sum_bksub</th><th>RA</th><th>DEC</th><th>instrumental_mag</th><th>e_instrumental_mag</th><th>calibrated_mag</th></tr></thead>\n<thead><tr><th></th><th>pix</th><th>pix</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead>\n<thead><tr><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>\n<tr><td>1</td><td>268.02736675955174</td><td>20.149766446447885</td><td>61767.39223096698</td><td>302.6670456258519</td><td>483.8261654823791</td><td>37999.618177349046</td><td>23767.774053617934</td><td>359.2180153456031</td><td>56.62336152646407</td><td>-7.247168138777317</td><td>0.012734345460498852</td><td>13.398669178861303</td></tr>\n<tr><td>2</td><td>447.4126333769818</td><td>37.3414972553207</td><td>48869.15532358869</td><td>273.5683335902122</td><td>484.2084280222172</td><td>38029.64100702149</td><td>10839.514316567198</td><td>359.3064996053953</td><td>56.62863809484198</td><td>-6.394721421483451</td><td>0.025238061927930502</td><td>14.251115896155168</td></tr>\n<tr><td>3</td><td>545.7080019283434</td><td>53.98664900274596</td><td>192596.8190774953</td><td>511.5521372938785</td><td>488.6028167761564</td><td>38374.775492681314</td><td>154222.043584814</td><td>359.3549563204108</td><td>56.633467085651</td><td>-9.277562997277917</td><td>0.0033169845594255257</td><td>11.368274320360703</td></tr>\n<tr><td>4</td><td>304.2721889165446</td><td>65.91196588179768</td><td>57799.97189305286</td><td>294.0232886316567</td><td>484.35189201882804</td><td>38040.90864296667</td><td>19759.06325008619</td><td>359.2356250342082</td><td>56.63592989075385</td><td>-7.04661274179522</td><td>0.014880426511635068</td><td>13.599224575843401</td></tr>\n<tr><td>5</td><td>240.92083966983117</td><td>76.15503283230126</td><td>99865.842324329</td><td>375.6798155511905</td><td>486.1332918135038</td><td>38180.81945566816</td><td>61685.02286866084</td><td>359.20426422118624</td><td>56.63849128947169</td><td>-8.282646188394304</td><td>0.006090292231083132</td><td>12.363191129244315</td></tr>\n<tr><td>6</td><td>282.5320356896614</td><td>80.30689922776746</td><td>62056.764485407664</td><td>303.2878573646761</td><td>486.491220617358</td><td>38208.93111818558</td><td>23847.833367222083</td><td>359.2247940338126</td><td>56.63976771029375</td><td>-7.25081918438724</td><td>0.01271762732884294</td><td>13.39501813325138</td></tr>\n<tr><td>7</td><td>225.76382783895122</td><td>81.99753980670626</td><td>47281.33643164313</td><td>269.76928783593866</td><td>486.06783601260406</td><td>38175.67856908713</td><td>9105.657862556</td><td>359.19673807963846</td><td>56.640025084150565</td><td>-6.205475183271978</td><td>0.02962655657701301</td><td>14.44036213436664</td></tr>\n<tr><td>8</td><td>293.7582716078041</td><td>83.70889597006358</td><td>59953.83636348944</td><td>298.7469128989249</td><td>485.97998240457326</td><td>38168.77856284761</td><td>21785.05780064183</td><td>359.23031851099273</td><td>56.64073187645059</td><td>-7.152593654585634</td><td>0.013713386286729213</td><td>13.493243663052986</td></tr>\n<tr><td>9</td><td>1051.8573726923953</td><td>83.75394510064639</td><td>101023.82738992215</td><td>377.67804323607504</td><td>486.1266420755353</td><td>38180.29718646941</td><td>62843.53020345274</td><td>359.6048716441954</td><td>56.64282427671765</td><td>-8.302848296514732</td><td>0.006009815839647479</td><td>12.342989021123888</td></tr>\n<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>\n<tr><td>179</td><td>489.94747621008986</td><td>683.5282367577056</td><td>46024.299029511276</td><td>266.72330250032206</td><td>486.9119875036022</td><td>38241.97807215305</td><td>7782.320957358228</td><td>359.3238446336028</td><td>56.80445630159114</td><td>-6.034969708069465</td><td>0.034272976398915245</td><td>14.610867609569155</td></tr>\n<tr><td>180</td><td>297.0109278797927</td><td>686.2458447555688</td><td>49461.84563562425</td><td>274.9729632540447</td><td>488.0749880283909</td><td>38333.31991977298</td><td>11128.525715851276</td><td>359.2280930666486</td><td>56.80455742930337</td><td>-6.423290947469841</td><td>0.024708840171198784</td><td>14.222546370168779</td></tr>\n<tr><td>181</td><td>565.8918748225475</td><td>693.0911785980809</td><td>50741.64014423935</td><td>277.9817679648873</td><td>491.8239355763539</td><td>38627.76157165733</td><td>12113.87857258202</td><td>359.36147692265456</td><td>56.807287194894286</td><td>-6.515404903342173</td><td>0.02294737942924887</td><td>14.130432414296447</td></tr>\n<tr><td>182</td><td>1029.0659933646366</td><td>693.5779579714971</td><td>57420.14631044407</td><td>293.18240230016295</td><td>486.14098905409685</td><td>38181.42399553067</td><td>19238.7223149134</td><td>359.5913297748133</td><td>56.808582137499926</td><td>-7.01763742876405</td><td>0.015239182597531174</td><td>13.628199888874569</td></tr>\n<tr><td>183</td><td>75.6975909394727</td><td>695.1118473945148</td><td>46224.4712829754</td><td>267.21067347064695</td><td>490.48295050526133</td><td>38522.44085045938</td><td>7702.030432516018</td><td>359.11821710248097</td><td>56.806146032176386</td><td>-6.0237099389227104</td><td>0.03469353643976156</td><td>14.62212737871591</td></tr>\n<tr><td>184</td><td>546.8967216865667</td><td>697.8302403130353</td><td>70269.4703250555</td><td>320.4060574096344</td><td>489.4436596689968</td><td>38440.81513905559</td><td>31828.655185999916</td><td>359.3520246789354</td><td>56.808518952881805</td><td>-7.564242586549009</td><td>0.01006659111223045</td><td>13.081594731089611</td></tr>\n<tr><td>185</td><td>379.60102660070277</td><td>709.9540672465369</td><td>56859.21903682446</td><td>291.9361498505045</td><td>486.94443515735566</td><td>38244.5265049195</td><td>18614.692531904962</td><td>359.2689298369349</td><td>56.81128508346357</td><td>-6.9818365310924</td><td>0.01568310351353565</td><td>13.66400078654622</td></tr>\n<tr><td>186</td><td>85.57601484331674</td><td>713.349464459503</td><td>48229.9434275828</td><td>272.0453228949139</td><td>489.75816530909805</td><td>38465.51635426695</td><td>9764.427073315856</td><td>359.12298842677063</td><td>56.81114298472934</td><td>-6.281313778677059</td><td>0.027860858691684746</td><td>14.36452353896156</td></tr>\n<tr><td>187</td><td>416.7496344017863</td><td>719.6156371344576</td><td>47473.81063864873</td><td>270.23264998781866</td><td>486.15191847383375</td><td>38182.28239014951</td><td>9291.52824849922</td><td>359.28730876533274</td><td>56.81403430709583</td><td>-6.227414742185077</td><td>0.029083767789380287</td><td>14.418422575453542</td></tr>\n<tr><td>188</td><td>584.9221123696184</td><td>734.4183160775481</td><td>29576.44346164675</td><td>213.6577404872811</td><td>260.16948630449434</td><td>20433.663671560746</td><td>9142.779790086006</td><td>359.3706992638583</td><td>56.81857932180142</td><td>-6.209892512259044</td><td>0.02336901307838141</td><td>14.435944805379576</td></tr>\n</table></div>","text/plain":"<QTable length=188>\n  id       xcenter       ...   e_instrumental_mag    calibrated_mag  \n             pix         ...                                         \nint64      float64       ...        float64             float64      \n----- ------------------ ... --------------------- ------------------\n    1 268.02736675955174 ...  0.012734345460498852 13.398669178861303\n    2  447.4126333769818 ...  0.025238061927930502 14.251115896155168\n    3  545.7080019283434 ... 0.0033169845594255257 11.368274320360703\n    4  304.2721889165446 ...  0.014880426511635068 13.599224575843401\n    5 240.92083966983117 ...  0.006090292231083132 12.363191129244315\n    6  282.5320356896614 ...   0.01271762732884294  13.39501813325138\n    7 225.76382783895122 ...   0.02962655657701301  14.44036213436664\n    8  293.7582716078041 ...  0.013713386286729213 13.493243663052986\n    9 1051.8573726923953 ...  0.006009815839647479 12.342989021123888\n  ...                ... ...                   ...                ...\n  179 489.94747621008986 ...  0.034272976398915245 14.610867609569155\n  180  297.0109278797927 ...  0.024708840171198784 14.222546370168779\n  181  565.8918748225475 ...   0.02294737942924887 14.130432414296447\n  182 1029.0659933646366 ...  0.015239182597531174 13.628199888874569\n  183   75.6975909394727 ...   0.03469353643976156  14.62212737871591\n  184  546.8967216865667 ...   0.01006659111223045 13.081594731089611\n  185 379.60102660070277 ...   0.01568310351353565  13.66400078654622\n  186  85.57601484331674 ...  0.027860858691684746  14.36452353896156\n  187  416.7496344017863 ...  0.029083767789380287 14.418422575453542\n  188  584.9221123696184 ...   0.02336901307838141 14.435944805379576"},"exec_count":28}},"pos":42.5,"start":1734529113326,"state":"done","type":"cell"}
{"end":1734529113350,"exec_count":29,"id":"a97b62","input":"# V30 Mask and Zero point calculation\nmask = (V_30_xmatch[\"Vmag\"] >= 11)\nmag = V_30_delta_mag\nZP = V_30_delta_mag[mask]\nZP_median_V30 = np.median(ZP)\nprint(f\"The median for the masked zero point is {ZP_median_V30}\")\nV30['calibrated_mag'] = V30['instrumental_mag'] + ZP_median_V30\nV30","kernel":"python3","last":5,"output":{"0":{"name":"stdout","text":"The median for the masked zero point is 21.207868147032755\n"},"1":{"data":{"text/html":"<div><i>QTable length=746</i>\n<table id=\"table139728156475744\" class=\"table-striped table-bordered table-condensed\">\n<thead><tr><th>id</th><th>xcenter</th><th>ycenter</th><th>aperture_sum</th><th>aperture_sum_err</th><th>sky_mean</th><th>aper_bkg</th><th>aper_sum_bksub</th><th>RA</th><th>DEC</th><th>instrumental_mag</th><th>e_instrumental_mag</th><th>calibrated_mag</th></tr></thead>\n<thead><tr><th></th><th>pix</th><th>pix</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead>\n<thead><tr><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>\n<tr><td>1</td><td>950.0375204773163</td><td>0.3886256633949748</td><td>70576.65220200509</td><td>314.12953307187405</td><td>680.1788049133763</td><td>53421.11841608371</td><td>17155.533785921383</td><td>359.5552624522192</td><td>56.62026752584726</td><td>-6.893207451850175</td><td>0.018310682546623127</td><td>14.31466069518258</td></tr>\n<tr><td>2</td><td>348.2575482264078</td><td>7.20286579499571</td><td>113184.43698825758</td><td>398.05715197770735</td><td>879.2005020425461</td><td>69052.24595623302</td><td>44132.191032024566</td><td>359.25798237777065</td><td>56.62042794083401</td><td>-7.919085586730262</td><td>0.009019655327986249</td><td>13.288782560302494</td></tr>\n<tr><td>3</td><td>1049.5748779071414</td><td>7.336683069002547</td><td>117661.55385253901</td><td>405.30204533247036</td><td>893.6480072795927</td><td>70186.95036411817</td><td>47474.60348842085</td><td>359.6044036312153</td><td>56.62236707578502</td><td>-7.99835022860816</td><td>0.008537239187923377</td><td>13.209517918424595</td></tr>\n<tr><td>4</td><td>231.9442484946911</td><td>8.10643597515521</td><td>112593.29345017544</td><td>397.0906819220072</td><td>913.479375797477</td><td>71744.50240527859</td><td>40848.79104489685</td><td>359.20052621996155</td><td>56.62026486579352</td><td>-7.835144882550654</td><td>0.009720989820373518</td><td>13.3727232644821</td></tr>\n<tr><td>5</td><td>269.14054386541005</td><td>7.875793062418203</td><td>114455.97692332344</td><td>400.1281021067595</td><td>923.3236220869751</td><td>72517.66770085899</td><td>41938.30922246445</td><td>359.2188999147855</td><td>56.620335740702025</td><td>-7.863724157055661</td><td>0.009540873476425918</td><td>13.344143989977095</td></tr>\n<tr><td>6</td><td>473.6569056154273</td><td>7.928820358868076</td><td>120118.34787845405</td><td>409.22314214524124</td><td>904.1844801484151</td><td>71014.48300810417</td><td>49103.86487034988</td><td>359.3199176714754</td><td>56.62103607988119</td><td>-8.034986053070845</td><td>0.008333827555646038</td><td>13.17288209396191</td></tr>\n<tr><td>7</td><td>1034.3366890733703</td><td>7.6769017506455715</td><td>112572.81993986912</td><td>397.05716730322695</td><td>911.5022030421628</td><td>71589.21562020427</td><td>40983.60431966485</td><td>359.5968750075038</td><td>56.62242841233987</td><td>-7.83872223807263</td><td>0.009688195411175927</td><td>13.369145908960125</td></tr>\n<tr><td>8</td><td>392.34433142386496</td><td>8.98861163322726</td><td>113511.04548461996</td><td>398.59012440137144</td><td>946.4484850001877</td><td>74333.89018694448</td><td>39177.155297675476</td><td>359.2797475836486</td><td>56.62106114349185</td><td>-7.789779108543753</td><td>0.01017404457707069</td><td>13.418089038489002</td></tr>\n<tr><td>9</td><td>922.9993562094179</td><td>9.779954313591224</td><td>109700.17232360148</td><td>392.3263339908416</td><td>979.5350299610815</td><td>76932.50135148979</td><td>32767.670972111693</td><td>359.5418681431827</td><td>56.62275876686251</td><td>-7.595810798522372</td><td>0.011972969770257625</td><td>13.612057348510383</td></tr>\n<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>\n<tr><td>737</td><td>516.5839970779413</td><td>723.6676706404902</td><td>107917.82240360943</td><td>389.36216756599856</td><td>1060.1264015458635</td><td>83262.1328743267</td><td>24655.68952928274</td><td>359.3371072037691</td><td>56.81566170164541</td><td>-7.2869897448561805</td><td>0.01579198047183252</td><td>13.920878402176575</td></tr>\n<tr><td>738</td><td>598.3253210339549</td><td>725.9052524855992</td><td>117727.37328949747</td><td>405.40758899605135</td><td>969.6514912596133</td><td>76156.25003708972</td><td>41571.12325240775</td><td>359.3776808864502</td><td>56.81651539903361</td><td>-7.8541762614721495</td><td>0.00975214421160897</td><td>13.353691885560606</td></tr>\n<tr><td>739</td><td>919.5268790223649</td><td>726.3737662778605</td><td>114724.32652236769</td><td>400.5637933731893</td><td>924.1307216184692</td><td>72581.05714983043</td><td>42143.26937253725</td><td>359.53716684971346</td><td>56.81748050776939</td><td>-7.869017423427543</td><td>0.009504810598159656</td><td>13.338850723605212</td></tr>\n<tr><td>740</td><td>618.8546321457404</td><td>727.4408633870071</td><td>109610.51313396962</td><td>392.1777599513353</td><td>904.3419721770119</td><td>71026.85240310515</td><td>38583.660730864474</td><td>359.387866112997</td><td>56.81699231241317</td><td>-7.773205438564325</td><td>0.01016434813396589</td><td>13.43466270846843</td></tr>\n<tr><td>741</td><td>988.8339125882317</td><td>728.5468315596688</td><td>113752.69162175083</td><td>398.9839937103346</td><td>879.6763658964082</td><td>69089.62021591808</td><td>44663.07140583274</td><td>359.5715725913825</td><td>56.81822512506191</td><td>-7.932068326896698</td><td>0.008933196512280826</td><td>13.275799820136058</td></tr>\n<tr><td>742</td><td>1009.3390949044366</td><td>729.2775333036888</td><td>109975.63166179138</td><td>392.7824454697604</td><td>829.8520634575086</td><td>65176.428653111</td><td>44799.203008680386</td><td>359.58175178871</td><td>56.81846746649151</td><td>-7.935372582793799</td><td>0.008767621276513649</td><td>13.272495564238955</td></tr>\n<tr><td>743</td><td>859.6621458555715</td><td>731.7100382015727</td><td>117815.5569350761</td><td>404.5884209131757</td><td>757.9723267743426</td><td>59531.007335465925</td><td>58284.54959961018</td><td>359.5074178083092</td><td>56.81878986929828</td><td>-8.221080475101829</td><td>0.0069416067155451035</td><td>12.986787671930927</td></tr>\n<tr><td>744</td><td>464.49855099018265</td><td>733.2520653158518</td><td>91576.48948542349</td><td>357.5314028098131</td><td>718.0305699423714</td><td>56393.98908959615</td><td>35182.50039582734</td><td>359.3111905497413</td><td>56.81810270427467</td><td>-7.673013616263269</td><td>0.010162194238253075</td><td>13.534854530769486</td></tr>\n<tr><td>745</td><td>584.4209133299304</td><td>733.4406664489132</td><td>99764.05041577287</td><td>371.7895284710589</td><td>732.6038851548649</td><td>57538.574589846605</td><td>42225.47582592627</td><td>359.37073637023207</td><td>56.8185221898735</td><td>-7.871133243705428</td><td>0.008804862969543652</td><td>13.336734903327327</td></tr>\n<tr><td>746</td><td>975.8931487808844</td><td>734.6889077174031</td><td>92037.36838864454</td><td>355.6209657302751</td><td>685.0452096168808</td><td>53803.32494773182</td><td>38234.04344091272</td><td>359.5651222730994</td><td>56.81986614037993</td><td>-7.7633224363427</td><td>0.00930116026780833</td><td>13.444545710690054</td></tr>\n</table></div>","text/plain":"<QTable length=746>\n  id       xcenter       ...   e_instrumental_mag    calibrated_mag  \n             pix         ...                                         \nint64      float64       ...        float64             float64      \n----- ------------------ ... --------------------- ------------------\n    1  950.0375204773163 ...  0.018310682546623127  14.31466069518258\n    2  348.2575482264078 ...  0.009019655327986249 13.288782560302494\n    3 1049.5748779071414 ...  0.008537239187923377 13.209517918424595\n    4  231.9442484946911 ...  0.009720989820373518   13.3727232644821\n    5 269.14054386541005 ...  0.009540873476425918 13.344143989977095\n    6  473.6569056154273 ...  0.008333827555646038  13.17288209396191\n    7 1034.3366890733703 ...  0.009688195411175927 13.369145908960125\n    8 392.34433142386496 ...   0.01017404457707069 13.418089038489002\n    9  922.9993562094179 ...  0.011972969770257625 13.612057348510383\n  ...                ... ...                   ...                ...\n  737  516.5839970779413 ...   0.01579198047183252 13.920878402176575\n  738  598.3253210339549 ...   0.00975214421160897 13.353691885560606\n  739  919.5268790223649 ...  0.009504810598159656 13.338850723605212\n  740  618.8546321457404 ...   0.01016434813396589  13.43466270846843\n  741  988.8339125882317 ...  0.008933196512280826 13.275799820136058\n  742 1009.3390949044366 ...  0.008767621276513649 13.272495564238955\n  743  859.6621458555715 ... 0.0069416067155451035 12.986787671930927\n  744 464.49855099018265 ...  0.010162194238253075 13.534854530769486\n  745  584.4209133299304 ...  0.008804862969543652 13.336734903327327\n  746  975.8931487808844 ...   0.00930116026780833 13.444545710690054"},"exec_count":29}},"pos":42.75,"start":1734529113336,"state":"done","type":"cell"}
{"end":1734529113524,"exec_count":31,"id":"e708a5","input":"coo_V30 = SkyCoord(V30['RA'], V30['DEC'], unit=u.deg)\ncoo_B30 = SkyCoord(B30['RA'], B30['DEC'], unit=u.deg)\nidx, distance_2d, distance_3d = coo_V30.match_to_catalog_sky(coo_B30)\nB30 = B30[idx]\nmask = distance_2d < 3 * u.arcsec\nB30 = B30[mask]\nV30 = V30[mask]","kernel":"python3","last":82,"pos":45.5,"start":1734529113429,"state":"done","type":"cell"}
{"end":1734529398387,"exec_count":34,"id":"2e25d9","input":"#Create arryas of V and B calibrated data \nV30_mag = V30['calibrated_mag']\nB30_mag = B30['calibrated_mag']\n\n# Load in error on instrumental magnitude for B and V \nV30_error = V30['e_instrumental_mag']\nB30_error = B30['e_instrumental_mag']\n\n# Calculate B-V\nB_minus_V_30 = B30_mag-V30_mag\n\n#Calculate error on B-Vv\nerror30 = np.sqrt((V30_error**2) + (B30_error**2))\n\n#Plot V against B-V\n#plt.scatter(B_minus_V, V)\nplt.errorbar(B_minus_V_30, V30_mag, xerr=error30, fmt=\"o\", ecolor=\"r\")\nplt.xlim(-1, 2.5)\n\n#Invert Y axis\nplt.gca().invert_yaxis()\n\n#Plot formatting\nplt.xlabel(\"B-V\")\nplt.ylabel(\"V\")\nplt.title(\"Colour Magnitude diagram of NGC 7789 (30 second exposure time)\")\nplt.grid()\n\nplt.show()","kernel":"python3","last":0,"output":{"0":{"data":{"image/png":"7cab4b2d8dac79eb959468551bcbfcf0db2edc2d","text/plain":"<Figure size 864x504 with 1 Axes>"},"metadata":{"image/png":{"height":440,"width":734},"needs_background":"light"}}},"pos":47.5,"start":1734529398003,"state":"done","type":"cell"}
{"id":"b668ca","input":"","pos":8,"type":"cell"}
{"id":"b93e16","input":"","kernel":"python3","pos":46.5,"type":"cell"}
{"id":0,"time":1734631222796,"type":"user"}
{"last_load":1733147812282,"type":"file"}